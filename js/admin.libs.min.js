!function(a,b,c,d){var e=c("html"),f=c(a),g=c(b),h=c.fancybox=function(){h.open.apply(this,arguments)},i=navigator.userAgent.match(/msie/i),j=null,k=b.createTouch!==d,l=function(a){return a&&a.hasOwnProperty&&a instanceof c},m=function(a){return a&&"string"===c.type(a)},n=function(a){return m(a)&&0<a.indexOf("%")},o=function(a,b){var c=parseInt(a,10)||0;return b&&n(a)&&(c*=h.getViewport()[b]/100),Math.ceil(c)},p=function(a,b){return o(a,b)+"px"};c.extend(h,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!k,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(i?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:c.noop,beforeLoad:c.noop,afterLoad:c.noop,beforeShow:c.noop,afterShow:c.noop,beforeChange:c.noop,beforeClose:c.noop,afterClose:c.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,b){return a&&(c.isPlainObject(b)||(b={}),!1!==h.close(!0))?(c.isArray(a)||(a=l(a)?c(a).get():[a]),c.each(a,function(e,f){var g,i,j,k,n,o={};"object"===c.type(f)&&(f.nodeType&&(f=c(f)),l(f)?(o={href:f.data("fancybox-href")||f.attr("href"),title:f.data("fancybox-title")||f.attr("title"),isDom:!0,element:f},c.metadata&&c.extend(!0,o,f.metadata())):o=f),g=b.href||o.href||(m(f)?f:null),i=b.title!==d?b.title:o.title||"",k=(j=b.content||o.content)?"html":b.type||o.type,!k&&o.isDom&&(k=f.data("fancybox-type"),k||(k=(k=f.prop("class").match(/fancybox\.(\w+)/))?k[1]:null)),m(g)&&(k||(h.isImage(g)?k="image":h.isSWF(g)?k="swf":"#"===g.charAt(0)?k="inline":m(f)&&(k="html",j=f)),"ajax"===k&&(n=g.split(/\s+/,2),g=n.shift(),n=n.shift())),j||("inline"===k?g?j=c(m(g)?g.replace(/.*(?=#[^\s]+$)/,""):g):o.isDom&&(j=f):"html"===k?j=g:!k&&!g&&o.isDom&&(k="inline",j=f)),c.extend(o,{href:g,type:k,content:j,title:i,selector:n}),a[e]=o}),h.opts=c.extend(!0,{},h.defaults,b),b.keys!==d&&(h.opts.keys=b.keys?c.extend({},h.defaults.keys,b.keys):!1),h.group=a,h._start(h.opts.index)):void 0},cancel:function(){var a=h.coming;a&&!1!==h.trigger("onCancel")&&(h.hideLoading(),h.ajaxLoad&&h.ajaxLoad.abort(),h.ajaxLoad=null,h.imgPreload&&(h.imgPreload.onload=h.imgPreload.onerror=null),a.wrap&&a.wrap.stop(!0,!0).trigger("onReset").remove(),h.coming=null,h.current||h._afterZoomOut(a))},close:function(a){h.cancel(),!1!==h.trigger("beforeClose")&&(h.unbindEvents(),h.isActive&&(h.isOpen&&!0!==a?(h.isOpen=h.isOpened=!1,h.isClosing=!0,c(".fancybox-item, .fancybox-nav").remove(),h.wrap.stop(!0,!0).removeClass("fancybox-opened"),h.transitions[h.current.closeMethod]()):(c(".fancybox-wrap").stop(!0).trigger("onReset").remove(),h._afterZoomOut())))},play:function(a){var b=function(){clearTimeout(h.player.timer)},c=function(){b(),h.current&&h.player.isActive&&(h.player.timer=setTimeout(h.next,h.current.playSpeed))},d=function(){b(),g.unbind(".player"),h.player.isActive=!1,h.trigger("onPlayEnd")};!0===a||!h.player.isActive&&!1!==a?h.current&&(h.current.loop||h.current.index<h.group.length-1)&&(h.player.isActive=!0,g.bind({"onCancel.player beforeClose.player":d,"onUpdate.player":c,"beforeLoad.player":b}),c(),h.trigger("onPlayStart")):d()},next:function(a){var b=h.current;b&&(m(a)||(a=b.direction.next),h.jumpto(b.index+1,a,"next"))},prev:function(a){var b=h.current;b&&(m(a)||(a=b.direction.prev),h.jumpto(b.index-1,a,"prev"))},jumpto:function(a,b,c){var e=h.current;e&&(a=o(a),h.direction=b||e.direction[a>=e.index?"next":"prev"],h.router=c||"jumpto",e.loop&&(0>a&&(a=e.group.length+a%e.group.length),a%=e.group.length),e.group[a]!==d&&(h.cancel(),h._start(a)))},reposition:function(a,b){var d,e=h.current,f=e?e.wrap:null;f&&(d=h._getPosition(b),a&&"scroll"===a.type?(delete d.position,f.stop(!0,!0).animate(d,200)):(f.css(d),e.pos=c.extend({},e.dim,d)))},update:function(a){var b=a&&a.type,c=!b||"orientationchange"===b;c&&(clearTimeout(j),j=null),h.isOpen&&!j&&(j=setTimeout(function(){var d=h.current;d&&!h.isClosing&&(h.wrap.removeClass("fancybox-tmp"),(c||"load"===b||"resize"===b&&d.autoResize)&&h._setDimension(),"scroll"===b&&d.canShrink||h.reposition(a),h.trigger("onUpdate"),j=null)},c&&!k?0:300))},toggle:function(a){h.isOpen&&(h.current.fitToView="boolean"===c.type(a)?a:!h.current.fitToView,k&&(h.wrap.removeAttr("style").addClass("fancybox-tmp"),h.trigger("onUpdate")),h.update())},hideLoading:function(){g.unbind(".loading"),c("#fancybox-loading").remove()},showLoading:function(){var a,b;h.hideLoading(),a=c('<div id="fancybox-loading"><div></div></div>').click(h.cancel).appendTo("body"),g.bind("keydown.loading",function(a){27===(a.which||a.keyCode)&&(a.preventDefault(),h.cancel())}),h.defaults.fixed||(b=h.getViewport(),a.css({position:"absolute",top:.5*b.h+b.y,left:.5*b.w+b.x}))},getViewport:function(){var b=h.current&&h.current.locked||!1,c={x:f.scrollLeft(),y:f.scrollTop()};return b?(c.w=b[0].clientWidth,c.h=b[0].clientHeight):(c.w=k&&a.innerWidth?a.innerWidth:f.width(),c.h=k&&a.innerHeight?a.innerHeight:f.height()),c},unbindEvents:function(){h.wrap&&l(h.wrap)&&h.wrap.unbind(".fb"),g.unbind(".fb"),f.unbind(".fb")},bindEvents:function(){var a,b=h.current;b&&(f.bind("orientationchange.fb"+(k?"":" resize.fb")+(b.autoCenter&&!b.locked?" scroll.fb":""),h.update),(a=b.keys)&&g.bind("keydown.fb",function(e){var f=e.which||e.keyCode,g=e.target||e.srcElement;return 27===f&&h.coming?!1:(!(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||g&&(g.type||c(g).is("[contenteditable]"))||!c.each(a,function(a,g){return 1<b.group.length&&g[f]!==d?(h[a](g[f]),e.preventDefault(),!1):-1<c.inArray(f,g)?(h[a](),e.preventDefault(),!1):void 0})),void 0)}),c.fn.mousewheel&&b.mouseWheel&&h.wrap.bind("mousewheel.fb",function(a,d,e,f){for(var g=c(a.target||null),i=!1;g.length&&!i&&!g.is(".fancybox-skin")&&!g.is(".fancybox-wrap");)i=g[0]&&!(g[0].style.overflow&&"hidden"===g[0].style.overflow)&&(g[0].clientWidth&&g[0].scrollWidth>g[0].clientWidth||g[0].clientHeight&&g[0].scrollHeight>g[0].clientHeight),g=c(g).parent();0!==d&&!i&&1<h.group.length&&!b.canShrink&&(f>0||e>0?h.prev(f>0?"down":"left"):(0>f||0>e)&&h.next(0>f?"up":"right"),a.preventDefault())}))},trigger:function(a,b){var d,e=b||h.coming||h.current;if(e){if(c.isFunction(e[a])&&(d=e[a].apply(e,Array.prototype.slice.call(arguments,1))),!1===d)return!1;e.helpers&&c.each(e.helpers,function(b,d){d&&h.helpers[b]&&c.isFunction(h.helpers[b][a])&&h.helpers[b][a](c.extend(!0,{},h.helpers[b].defaults,d),e)}),g.trigger(a)}},isImage:function(a){return m(a)&&a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(a){return m(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(a){var b,d,e={};if(a=o(a),b=h.group[a]||null,!b)return!1;if(e=c.extend(!0,{},h.opts,b),b=e.margin,d=e.padding,"number"===c.type(b)&&(e.margin=[b,b,b,b]),"number"===c.type(d)&&(e.padding=[d,d,d,d]),e.modal&&c.extend(!0,e,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),e.autoSize&&(e.autoWidth=e.autoHeight=!0),"auto"===e.width&&(e.autoWidth=!0),"auto"===e.height&&(e.autoHeight=!0),e.group=h.group,e.index=a,h.coming=e,!1===h.trigger("beforeLoad"))h.coming=null;else{if(d=e.type,b=e.href,!d)return h.coming=null,h.current&&h.router&&"jumpto"!==h.router?(h.current.index=a,h[h.router](h.direction)):!1;if(h.isActive=!0,("image"===d||"swf"===d)&&(e.autoHeight=e.autoWidth=!1,e.scrolling="visible"),"image"===d&&(e.aspectRatio=!0),"iframe"===d&&k&&(e.scrolling="scroll"),e.wrap=c(e.tpl.wrap).addClass("fancybox-"+(k?"mobile":"desktop")+" fancybox-type-"+d+" fancybox-tmp "+e.wrapCSS).appendTo(e.parent||"body"),c.extend(e,{skin:c(".fancybox-skin",e.wrap),outer:c(".fancybox-outer",e.wrap),inner:c(".fancybox-inner",e.wrap)}),c.each(["Top","Right","Bottom","Left"],function(a,b){e.skin.css("padding"+b,p(e.padding[a]))}),h.trigger("onReady"),"inline"===d||"html"===d){if(!e.content||!e.content.length)return h._error("content")}else if(!b)return h._error("href");"image"===d?h._loadImage():"ajax"===d?h._loadAjax():"iframe"===d?h._loadIframe():h._afterLoad()}},_error:function(a){c.extend(h.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:a,content:h.coming.tpl.error}),h._afterLoad()},_loadImage:function(){var a=h.imgPreload=new Image;a.onload=function(){this.onload=this.onerror=null,h.coming.width=this.width/h.opts.pixelRatio,h.coming.height=this.height/h.opts.pixelRatio,h._afterLoad()},a.onerror=function(){this.onload=this.onerror=null,h._error("image")},a.src=h.coming.href,!0!==a.complete&&h.showLoading()},_loadAjax:function(){var a=h.coming;h.showLoading(),h.ajaxLoad=c.ajax(c.extend({},a.ajax,{url:a.href,error:function(a,b){h.coming&&"abort"!==b?h._error("ajax",a):h.hideLoading()},success:function(b,c){"success"===c&&(a.content=b,h._afterLoad())}}))},_loadIframe:function(){var a=h.coming,b=c(a.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",k?"auto":a.iframe.scrolling).attr("src",a.href);c(a.wrap).bind("onReset",function(){try{c(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(a){}}),a.iframe.preload&&(h.showLoading(),b.one("load",function(){c(this).data("ready",1),k||c(this).bind("load.fb",h.update),c(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),h._afterLoad()})),a.content=b.appendTo(a.inner),a.iframe.preload||h._afterLoad()},_preloadImages:function(){var a,b,c=h.group,d=h.current,e=c.length,f=d.preload?Math.min(d.preload,e-1):0;for(b=1;f>=b;b+=1)a=c[(d.index+b)%e],"image"===a.type&&a.href&&((new Image).src=a.href)},_afterLoad:function(){var a,b,d,e,f,g=h.coming,i=h.current;if(h.hideLoading(),g&&!1!==h.isActive)if(!1===h.trigger("afterLoad",g,i))g.wrap.stop(!0).trigger("onReset").remove(),h.coming=null;else{switch(i&&(h.trigger("beforeChange",i),i.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),h.unbindEvents(),a=g.content,b=g.type,d=g.scrolling,c.extend(h,{wrap:g.wrap,skin:g.skin,outer:g.outer,inner:g.inner,current:g,previous:i}),e=g.href,b){case"inline":case"ajax":case"html":g.selector?a=c("<div>").html(a).find(g.selector):l(a)&&(a.data("fancybox-placeholder")||a.data("fancybox-placeholder",c('<div class="fancybox-placeholder"></div>').insertAfter(a).hide()),a=a.show().detach(),g.wrap.bind("onReset",function(){c(this).find(a).length&&a.hide().replaceAll(a.data("fancybox-placeholder")).data("fancybox-placeholder",!1)}));break;case"image":a=g.tpl.image.replace("{href}",e);break;case"swf":a='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+e+'"></param>',f="",c.each(g.swf,function(b,c){a+='<param name="'+b+'" value="'+c+'"></param>',f+=" "+b+'="'+c+'"'}),a+='<embed src="'+e+'" type="application/x-shockwave-flash" width="100%" height="100%"'+f+"></embed></object>"}(!l(a)||!a.parent().is(g.inner))&&g.inner.append(a),h.trigger("beforeShow"),g.inner.css("overflow","yes"===d?"scroll":"no"===d?"hidden":d),h._setDimension(),h.reposition(),h.isOpen=!1,h.coming=null,h.bindEvents(),h.isOpened?i.prevMethod&&h.transitions[i.prevMethod]():c(".fancybox-wrap").not(g.wrap).stop(!0).trigger("onReset").remove(),h.transitions[h.isOpened?g.nextMethod:g.openMethod](),h._preloadImages()}},_setDimension:function(){var a,b,d,e,f,g,i,j,k,l=h.getViewport(),m=0,q=!1,r=!1,q=h.wrap,s=h.skin,t=h.inner,u=h.current,r=u.width,v=u.height,w=u.minWidth,x=u.minHeight,y=u.maxWidth,z=u.maxHeight,A=u.scrolling,B=u.scrollOutside?u.scrollbarWidth:0,C=u.margin,D=o(C[1]+C[3]),E=o(C[0]+C[2]);if(q.add(s).add(t).width("auto").height("auto").removeClass("fancybox-tmp"),C=o(s.outerWidth(!0)-s.width()),a=o(s.outerHeight(!0)-s.height()),b=D+C,d=E+a,e=n(r)?(l.w-b)*o(r)/100:r,f=n(v)?(l.h-d)*o(v)/100:v,"iframe"===u.type){if(k=u.content,u.autoHeight&&1===k.data("ready"))try{k[0].contentWindow.document.location&&(t.width(e).height(9999),g=k.contents().find("body"),B&&g.css("overflow-x","hidden"),f=g.outerHeight(!0))}catch(F){}}else(u.autoWidth||u.autoHeight)&&(t.addClass("fancybox-tmp"),u.autoWidth||t.width(e),u.autoHeight||t.height(f),u.autoWidth&&(e=t.width()),u.autoHeight&&(f=t.height()),t.removeClass("fancybox-tmp"));if(r=o(e),v=o(f),j=e/f,w=o(n(w)?o(w,"w")-b:w),y=o(n(y)?o(y,"w")-b:y),x=o(n(x)?o(x,"h")-d:x),z=o(n(z)?o(z,"h")-d:z),g=y,i=z,u.fitToView&&(y=Math.min(l.w-b,y),z=Math.min(l.h-d,z)),b=l.w-D,E=l.h-E,u.aspectRatio?(r>y&&(r=y,v=o(r/j)),v>z&&(v=z,r=o(v*j)),w>r&&(r=w,v=o(r/j)),x>v&&(v=x,r=o(v*j))):(r=Math.max(w,Math.min(r,y)),u.autoHeight&&"iframe"!==u.type&&(t.width(r),v=t.height()),v=Math.max(x,Math.min(v,z))),u.fitToView)if(t.width(r).height(v),q.width(r+C),l=q.width(),D=q.height(),u.aspectRatio)for(;(l>b||D>E)&&r>w&&v>x&&!(19<m++);)v=Math.max(x,Math.min(z,v-10)),r=o(v*j),w>r&&(r=w,v=o(r/j)),r>y&&(r=y,v=o(r/j)),t.width(r).height(v),q.width(r+C),l=q.width(),D=q.height();else r=Math.max(w,Math.min(r,r-(l-b))),v=Math.max(x,Math.min(v,v-(D-E)));B&&"auto"===A&&f>v&&b>r+C+B&&(r+=B),t.width(r).height(v),q.width(r+C),l=q.width(),D=q.height(),q=(l>b||D>E)&&r>w&&v>x,r=u.aspectRatio?g>r&&i>v&&e>r&&f>v:(g>r||i>v)&&(e>r||f>v),c.extend(u,{dim:{width:p(l),height:p(D)},origWidth:e,origHeight:f,canShrink:q,canExpand:r,wPadding:C,hPadding:a,wrapSpace:D-s.outerHeight(!0),skinSpace:s.height()-v}),!k&&u.autoHeight&&v>x&&z>v&&!r&&t.height("auto")},_getPosition:function(a){var b=h.current,c=h.getViewport(),d=b.margin,e=h.wrap.width()+d[1]+d[3],f=h.wrap.height()+d[0]+d[2],d={position:"absolute",top:d[0],left:d[3]};return b.autoCenter&&b.fixed&&!a&&f<=c.h&&e<=c.w?d.position="fixed":b.locked||(d.top+=c.y,d.left+=c.x),d.top=p(Math.max(d.top,d.top+(c.h-f)*b.topRatio)),d.left=p(Math.max(d.left,d.left+(c.w-e)*b.leftRatio)),d},_afterZoomIn:function(){var a=h.current;a&&(h.isOpen=h.isOpened=!0,h.wrap.css("overflow","visible").addClass("fancybox-opened"),h.update(),(a.closeClick||a.nextClick&&1<h.group.length)&&h.inner.css("cursor","pointer").bind("click.fb",function(b){!c(b.target).is("a")&&!c(b.target).parent().is("a")&&(b.preventDefault(),h[a.closeClick?"close":"next"]())}),a.closeBtn&&c(a.tpl.closeBtn).appendTo(h.skin).bind("click.fb",function(a){a.preventDefault(),h.close()}),a.arrows&&1<h.group.length&&((a.loop||0<a.index)&&c(a.tpl.prev).appendTo(h.outer).bind("click.fb",h.prev),(a.loop||a.index<h.group.length-1)&&c(a.tpl.next).appendTo(h.outer).bind("click.fb",h.next)),h.trigger("afterShow"),a.loop||a.index!==a.group.length-1?h.opts.autoPlay&&!h.player.isActive&&(h.opts.autoPlay=!1,h.play()):h.play(!1))},_afterZoomOut:function(a){a=a||h.current,c(".fancybox-wrap").trigger("onReset").remove(),c.extend(h,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),h.trigger("afterClose",a)}}),h.transitions={getOrigPosition:function(){var a=h.current,b=a.element,c=a.orig,d={},e=50,f=50,g=a.hPadding,i=a.wPadding,j=h.getViewport();return!c&&a.isDom&&b.is(":visible")&&(c=b.find("img:first"),c.length||(c=b)),l(c)?(d=c.offset(),c.is("img")&&(e=c.outerWidth(),f=c.outerHeight())):(d.top=j.y+(j.h-f)*a.topRatio,d.left=j.x+(j.w-e)*a.leftRatio),("fixed"===h.wrap.css("position")||a.locked)&&(d.top-=j.y,d.left-=j.x),d={top:p(d.top-g*a.topRatio),left:p(d.left-i*a.leftRatio),width:p(e+i),height:p(f+g)}},step:function(a,b){var c,d,e=b.prop;d=h.current;var f=d.wrapSpace,g=d.skinSpace;("width"===e||"height"===e)&&(c=b.end===b.start?1:(a-b.start)/(b.end-b.start),h.isClosing&&(c=1-c),d="width"===e?d.wPadding:d.hPadding,d=a-d,h.skin[e](o("width"===e?d:d-f*c)),h.inner[e](o("width"===e?d:d-f*c-g*c)))},zoomIn:function(){var a=h.current,b=a.pos,d=a.openEffect,e="elastic"===d,f=c.extend({opacity:1},b);delete f.position,e?(b=this.getOrigPosition(),a.openOpacity&&(b.opacity=.1)):"fade"===d&&(b.opacity=.1),h.wrap.css(b).animate(f,{duration:"none"===d?0:a.openSpeed,easing:a.openEasing,step:e?this.step:null,complete:h._afterZoomIn})},zoomOut:function(){var a=h.current,b=a.closeEffect,c="elastic"===b,d={opacity:.1};c&&(d=this.getOrigPosition(),a.closeOpacity&&(d.opacity=.1)),h.wrap.animate(d,{duration:"none"===b?0:a.closeSpeed,easing:a.closeEasing,step:c?this.step:null,complete:h._afterZoomOut})},changeIn:function(){var a,b=h.current,c=b.nextEffect,d=b.pos,e={opacity:1},f=h.direction;d.opacity=.1,"elastic"===c&&(a="down"===f||"up"===f?"top":"left","down"===f||"right"===f?(d[a]=p(o(d[a])-200),e[a]="+=200px"):(d[a]=p(o(d[a])+200),e[a]="-=200px")),"none"===c?h._afterZoomIn():h.wrap.css(d).animate(e,{duration:b.nextSpeed,easing:b.nextEasing,complete:h._afterZoomIn})},changeOut:function(){var a=h.previous,b=a.prevEffect,d={opacity:.1},e=h.direction;"elastic"===b&&(d["down"===e||"up"===e?"top":"left"]=("up"===e||"left"===e?"-":"+")+"=200px"),a.wrap.animate(d,{duration:"none"===b?0:a.prevSpeed,easing:a.prevEasing,complete:function(){c(this).trigger("onReset").remove()}})}},h.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!k,fixed:!0},overlay:null,fixed:!1,el:c("html"),create:function(a){a=c.extend({},this.defaults,a),this.overlay&&this.close(),this.overlay=c('<div class="fancybox-overlay"></div>').appendTo(h.coming?h.coming.parent:a.parent),this.fixed=!1,a.fixed&&h.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(a){var b=this;a=c.extend({},this.defaults,a),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(a),this.fixed||(f.bind("resize.overlay",c.proxy(this.update,this)),this.update()),a.closeClick&&this.overlay.bind("click.overlay",function(a){return c(a.target).hasClass("fancybox-overlay")?(h.isActive?h.close():b.close(),!1):void 0}),this.overlay.css(a.css).show()},close:function(){var a,b;f.unbind("resize.overlay"),this.el.hasClass("fancybox-lock")&&(c(".fancybox-margin").removeClass("fancybox-margin"),a=f.scrollTop(),b=f.scrollLeft(),this.el.removeClass("fancybox-lock"),f.scrollTop(a).scrollLeft(b)),c(".fancybox-overlay").remove().hide(),c.extend(this,{overlay:null,fixed:!1})},update:function(){var a,c="100%";this.overlay.width(c).height("100%"),i?(a=Math.max(b.documentElement.offsetWidth,b.body.offsetWidth),g.width()>a&&(c=g.width())):g.width()>f.width()&&(c=g.width()),this.overlay.width(c).height(g.height())},onReady:function(a,b){var d=this.overlay;c(".fancybox-overlay").stop(!0,!0),d||this.create(a),a.locked&&this.fixed&&b.fixed&&(d||(this.margin=g.height()>f.height()?c("html").css("margin-right").replace("px",""):!1),b.locked=this.overlay.append(b.wrap),b.fixed=!1),!0===a.showEarly&&this.beforeShow.apply(this,arguments)},beforeShow:function(a,b){var d,e;b.locked&&(!1!==this.margin&&(c("*").filter(function(){return"fixed"===c(this).css("position")&&!c(this).hasClass("fancybox-overlay")&&!c(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),d=f.scrollTop(),e=f.scrollLeft(),this.el.addClass("fancybox-lock"),f.scrollTop(d).scrollLeft(e)),this.open(a)},onUpdate:function(){this.fixed||this.update()},afterClose:function(a){this.overlay&&!h.coming&&this.overlay.fadeOut(a.speedOut,c.proxy(this.close,this))}},h.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(a){var b=h.current,d=b.title,e=a.type;if(c.isFunction(d)&&(d=d.call(b.element,b)),m(d)&&""!==c.trim(d)){switch(b=c('<div class="fancybox-title fancybox-title-'+e+'-wrap">'+d+"</div>"),e){case"inside":e=h.skin;break;case"outside":e=h.wrap;break;case"over":e=h.inner;break;default:e=h.skin,b.appendTo("body"),i&&b.width(b.width()),b.wrapInner('<span class="child"></span>'),h.current.margin[2]+=Math.abs(o(b.css("margin-bottom")))}b["top"===a.position?"prependTo":"appendTo"](e)}}},c.fn.fancybox=function(a){var b,d=c(this),e=this.selector||"",f=function(f){var g,i,j=c(this).blur(),k=b;!(f.ctrlKey||f.altKey||f.shiftKey||f.metaKey||j.is(".fancybox-wrap")||(g=a.groupAttr||"data-fancybox-group",i=j.attr(g),i||(g="rel",i=j.get(0)[g]),i&&""!==i&&"nofollow"!==i&&(j=e.length?c(e):d,j=j.filter("["+g+'="'+i+'"]'),k=j.index(this)),a.index=k,!1===h.open(j,a)||!f.preventDefault()))};return a=a||{},b=a.index||0,e&&!1!==a.live?g.undelegate(e,"click.fb-start").delegate(e+":not('.fancybox-item, .fancybox-nav')","click.fb-start",f):d.unbind("click.fb-start").bind("click.fb-start",f),this.filter("[data-fancybox-start=1]").trigger("click"),this},g.ready(function(){var b,f;if(c.scrollbarWidth===d&&(c.scrollbarWidth=function(){var a=c('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),b=a.children(),b=b.innerWidth()-b.height(99).innerWidth();return a.remove(),b}),c.support.fixedPosition===d){b=c.support,f=c('<div style="position:fixed;top:20px;"></div>').appendTo("body");var g=20===f[0].offsetTop||15===f[0].offsetTop;f.remove(),b.fixedPosition=g}c.extend(h.defaults,{scrollbarWidth:c.scrollbarWidth(),fixed:c.support.fixedPosition,parent:c("body")}),b=c(a).width(),e.addClass("fancybox-lock-test"),f=c(a).width(),e.removeClass("fancybox-lock-test"),c("<style type='text/css'>.fancybox-margin{margin-right:"+(f-b)+"px;}</style>").appendTo("head")})}(window,document,jQuery),function(a){"use strict";if(!a.jstree){var b=0,c=!1,d=!1,e=[];a.jstree={version:"2.0.0-alpha",defaults:{plugins:[]},plugins:{}},a.jstree.create=function(c,d){var e=new a.jstree.core(++b),f=d;return d=a.extend(!0,{},a.jstree.defaults,d),f&&f.plugins&&(d.plugins=f.plugins),a.each(d.plugins,function(a,b){"core"!==a&&(e=e.plugin(b,d[b]))}),e.init(c,d),e},a.jstree.core=function(a){this._id=a,this._data={core:{themes:{}}}},a.jstree.reference=function(b){return a(b).closest(".jstree").data("jstree")},a.fn.jstree=function(b){var c="string"==typeof b,d=Array.prototype.slice.call(arguments,1),e=null;return this.each(function(){var f=a(this).data("jstree"),g=c&&f?f[b]:null;return e=c&&g?g.apply(f,d):null,f||a(this).data("jstree",new a.jstree.create(this,b)),null!==e&&void 0!==e?!1:void 0}),null!==e&&void 0!==e?e:this},a.expr[":"].jstree=a.expr.createPseudo(function(){return function(b){return a(b).hasClass("jstree")&&void 0!==a(b).data("jstree")}}),a.jstree.defaults.core={strings:!1,check_callback:!0,animation:100,aria_roles:!1,multiple:!0,themes:{name:!1,url:!0,dots:!0,icons:!0,dir:!1},base_height:!1,clean_loaded:!0,correct_loaded:!0,expand_selected_onload:!0},a.jstree.core.prototype={plugin:function(b,c){var d=a.jstree.plugins[b];return d?(this._data[b]={},d.prototype=this,new d(c,this)):this},init:function(b,c){this.element=a(b).addClass("jstree jstree-"+this._id),this.settings=c,this.element.bind("destroyed",a.proxy(this.teardown,this)),this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.settings.core.aria_roles&&this.element.attr("role","tree"),this._data.core.selected=a(),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul><li class='jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'>"+this.get_string("Loading ...")+"</a></li></ul>"),this._data.core.li_height=this.settings.base_height||this.get_container_ul().children("li:eq(0)").height()||18,this.load_node(-1)},destroy:function(){this.element.unbind("destroyed",this.teardown),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){a.support.touch&&this.element.addTouch(),this.element.on("dblclick.jstree",function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var a=window.getSelection();try{a.removeAllRanges(),a.collapse()}catch(b){}}}).on("click.jstree",".jstree-ocl",a.proxy(function(a){this.toggle_node(a.target)},this)).on("click.jstree",".jstree-anchor",a.proxy(function(a){a.preventDefault(),this.activate_node(a.currentTarget,a)},this)).on("keydown.jstree",".jstree-anchor",a.proxy(function(b){var c=null;switch(b.which){case 13:case 32:b.type="click",a(b.currentTarget).trigger(b);break;case 37:b.preventDefault(),this.is_open(b.currentTarget)?this.close_node(b.currentTarget):(c=this.get_prev(b.currentTarget),c&&c.length&&c.children(".jstree-anchor").focus());break;case 38:b.preventDefault(),c=this.get_prev(b.currentTarget),c&&c.length&&c.children(".jstree-anchor").focus();break;case 39:b.preventDefault(),this.is_closed(b.currentTarget)?this.open_node(b.currentTarget):(c=this.get_next(b.currentTarget),c&&c.length&&c.children(".jstree-anchor").focus());break;case 40:b.preventDefault(),c=this.get_next(b.currentTarget),c&&c.length&&c.children(".jstree-anchor").focus()}},this)).on("create_node.jstree",a.proxy(function(a,b){this.clean_node(b.node)},this)).on("load_node.jstree",a.proxy(function(b,c){if(c.status){if(this.settings.core.clean_loaded)if(-1===c.node){var d=this.get_container_ul().detach();d.children("li").length&&this.clean_node(d.children("li")),this.element.prepend(d)}else{var e=this._data.core.selected.length;c.node.children("ul").children("li").length&&this.clean_node(c.node.children("ul").children("li")),this._data.core.ready&&e!==this._data.core.selected.length&&this.trigger("changed",{action:"clean_node",selected:this._data.core.selected})}-1!==c.node||this._data.core.loaded||(this._data.core.loaded=!0,this.trigger("loaded")),this._data.core.ready||this.get_container_ul().find(".jstree-loading:eq(0)").length||(this._data.core.ready=!0,this._data.core.selected.length&&(this.settings.core.expand_selected_onload&&this._data.core.selected.parents(".jstree-closed").each(a.proxy(function(a,b){this.open_node(b,!1,0)},this)),this.trigger("changed",{action:"ready",selected:this._data.core.selected})),this.trigger("ready"))}},this)).on("loaded.jstree",a.proxy(function(a,b){this.settings.core.correct_loaded&&b.instance.get_container_ul().children("li").each(function(){b.instance.correct_node(this)})},this)).on("open_node.jstree",a.proxy(function(a,b){this.settings.core.correct_loaded&&b.node.children("li").each(function(){b.instance.correct_node(this)})},this)).on("init.jstree",a.proxy(function(){var a=this.settings.core.themes;this._data.core.themes.dots=a.dots,this._data.core.themes.icons=a.icons,a.name===!1&&(a.name="default"),this.set_theme(a.name,a.url)},this)).on("loaded.jstree",a.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"]()},this)).on("focus.jstree",".jstree-anchor",a.proxy(function(b){a(b.currentTarget).mouseenter()},this)).on("blur.jstree",".jstree-anchor",a.proxy(function(b){a(b.currentTarget).mouseleave()},this)).on("mouseenter.jstree",".jstree-anchor",a.proxy(function(a){var b=this.element.find(".jstree-anchor:focus").not(".jstree-clicked");b&&b.length&&b[0]!==a.currentTarget&&b.blur(),this.hover_node(a.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",a.proxy(function(a){this.dehover_node(a.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),a(document).off(".jstree-"+this._id)},trigger:function(b,c,d){c||(c={}),c.instance=this,"number"===(typeof d).toLowerCase()?setTimeout(a.proxy(function(){this.element.triggerHandler(b.replace(".jstree","")+".jstree",c)},this),d):this.element.triggerHandler(b.replace(".jstree","")+".jstree",c)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children("ul:eq(0)")},get_string:function(b){var c=this.settings.core.strings;return a.isFunction(c)?c.call(this,b):c&&c[b]?c[b]:b},_firstChild:function(a){for(a=a?a.firstChild:null;null!==a&&1!==a.nodeType;)a=a.nextSibling;return a},_nextSibling:function(a){for(a=a?a.nextSibling:null;null!==a&&1!==a.nodeType;)a=a.nextSibling;return a},_previousSibling:function(a){for(a=a?a.previousSibling:null;null!==a&&1!==a.nodeType;)a=a.previousSibling;return a},get_node:function(b){return-1===b?-1:(b=a(b,this.element),b.hasClass(".jstree")?-1:(b=b.closest("li",this.element),b.length?b:!1))},get_next:function(b,c){var d;return b=this.get_node(b),-1===b?(d=this._firstChild(this.get_container_ul()[0]),d?a(d):!1):b&&b.length?c?(d=this._nextSibling(b[0]),d?a(d):!1):b.hasClass("jstree-open")?(d=this._firstChild(b.children("ul")[0]),d?a(d):!1):(d=this._nextSibling(b[0]))?a(d):b.parentsUntil(".jstree","li").next("li").eq(0):!1},get_prev:function(b,c){var d;if(b=this.get_node(b),-1===b)return d=this.get_container_ul()[0].lastChild,d?a(d):!1;if(!b||!b.length)return!1;if(c)return d=this._previousSibling(b[0]),d?a(d):!1;if(d=this._previousSibling(b[0])){for(b=a(d);b.hasClass("jstree-open");)b=b.children("ul:eq(0)").children("li:last");return b}return d=b[0].parentNode.parentNode,d&&"LI"===d.tagName?a(d):!1},get_parent:function(b){if(b=this.get_node(b),-1===b||!b||!b.length)return!1;var c=b[0].parentNode.parentNode;return"LI"===c.tagName?a(c):-1},get_children:function(a){return a=this.get_node(a),-1===a?this.get_container_ul().children("li"):a&&a.length?a.children("ul").children("li"):!1},is_parent:function(a){return a=this.get_node(a),a&&-1!==a&&(this._firstChild(a.children("ul")[0])||a.hasClass("jstree-closed"))},is_loaded:function(a){return a=this.get_node(a),a&&(-1===a&&!this.element.children("ul").children("li.jstree-loading").length||-1!==a&&!a.hasClass("jstree-loading")&&(this._firstChild(a.children("ul")[0])||a.hasClass("jstree-leaf")))},is_loading:function(a){return a=this.get_node(a),a&&(-1===a&&this.element.children("ul").children("li.jstree-loading").length||-1!==a&&a.hasClass("jstree-loading"))},is_open:function(a){return a=this.get_node(a),a&&-1!==a&&a.hasClass("jstree-open")},is_closed:function(a){return a=this.get_node(a),a&&-1!==a&&a.hasClass("jstree-closed")},is_leaf:function(a){return a=this.get_node(a),a&&-1!==a&&a.hasClass("jstree-leaf")},load_node:function(b,c){return(b=this.get_node(b))?(-1!==b&&b.addClass("jstree-loading"),this._load_node(b,a.proxy(function(a){-1!==b&&b.removeClass("jstree-loading"),this.trigger("load_node",{node:b,status:a}),c&&c.call(this,b,a)
},this)),!0):(c.call(this,b,!1),!1)},_load_node:function(a,b){-1===a?(this.get_container_ul().empty().append(this._data.core.original_container_html.clone(!0)),b.call(this,!0)):b.call(this,!1)},open_node:function(a,b,c){if(a=this.get_node(a),-1===a||!a||!a.length)return!1;if(c="undefined"===(typeof c).toLowerCase()?this.settings.core.animation:c,!this.is_closed(a))return b&&b.call(this,a,!1),!1;if(this.is_loaded(a)){var d=this;c?a.children("ul").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children("ul").stop(!0,!0).slideDown(c,function(){this.style.display="",d.trigger("after_open",{node:a})}):a[0].className=a[0].className.replace("jstree-closed","jstree-open"),b&&b.call(this,a,!0),this.trigger("open_node",{node:a}),c||this.trigger("after_open",{node:a})}else this.load_node(a,function(a,d){return d?this.open_node(a,b,c):b?b.call(this,a,!1):!1})},close_node:function(a,b){if(a=this.get_node(a),!a||!a.length||!this.is_open(a))return!1;b="undefined"===(typeof b).toLowerCase()?this.settings.core.animation:b;var c=this;b?a.children("ul").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children("ul").stop(!0,!0).slideUp(b,function(){this.style.display="",c.trigger("after_close",{node:a})}):a[0].className=a[0].className.replace("jstree-open","jstree-closed"),this.trigger("close_node",{node:a}),b||this.trigger("after_close",{node:a})},toggle_node:function(a){return this.is_closed(a)?this.open_node(a):this.is_open(a)?this.close_node(a):void 0},open_all:function(a,b,c){a=a?this.get_node(a):-1,a=a&&-1!==a?a:this.get_container_ul(),c=c||a;var d=this;a=this.is_closed(a)?a.find("li.jstree-closed").addBack():a.find("li.jstree-closed"),a.each(function(){d.open_node(this,d.is_loaded(this)?!1:function(a){this.open_all(a,b,c)},b||0)}),0===c.find("li.jstree-closed").length&&this.trigger("open_all",{node:c})},close_all:function(a,b){a=a?this.get_node(a):-1;var c=a&&-1!==a?a:this.get_container_ul(),d=this;c=this.is_open(c)?c.find("li.jstree-open").addBack():c.find("li.jstree-open"),c.each(function(){d.close_node(this,b||0)}),this.trigger("close_all",{node:a})},is_disabled:function(a){return a=this.get_node(a),a&&-1!==a&&a.children(".jstree-anchor").hasClass("jstree-disabled")},enable_node:function(a){return a=this.get_node(a),a&&a.length?(a.children(".jstree-anchor").removeClass("jstree-disabled"),this.trigger("enable_node",{node:a}),void 0):!1},disable_node:function(a){return a=this.get_node(a),a&&a.length?(a.children(".jstree-anchor").addClass("jstree-disabled"),this.trigger("disable_node",{node:a}),void 0):!1},activate_node:function(a,b){return this.is_disabled(a)?!1:(this.settings.core.multiple&&(b.metaKey||b.ctrlKey)?this.is_selected(a)?this.deselect_node(a):this.select_node(a):(this.deselect_all(!0),this.select_node(a)),this.trigger("activate_node",{node:a}),void 0)},hover_node:function(a){return a=this.get_node(a),a&&a.length?(a.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:a}),void 0):!1},dehover_node:function(a){return a=this.get_node(a),a&&a.length?(a.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:a}),void 0):!1},select_node:function(a,b,c){if(a=this.get_node(a),!a||!a.length)return!1;if(this._data.core.selected=this._data.core.selected.add(a),this.element.find(".jstree-clicked").removeClass("jstree-clicked"),this._data.core.selected.children(".jstree-anchor").addClass("jstree-clicked"),!c){var d=this;a.parents(".jstree-closed").each(function(){d.open_node(this,!1,0)})}this.trigger("select_node",{node:a,selected:this._data.core.selected}),b||this.trigger("changed",{action:"select_node",node:a,selected:this._data.core.selected})},deselect_node:function(a,b){return a=this.get_node(a),a&&a.length?(this._data.core.selected=this._data.core.selected.not(a),this.element.find(".jstree-clicked").removeClass("jstree-clicked"),this._data.core.selected.children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("deselect_node",{node:a,selected:this._data.core.selected}),b||this.trigger("changed",{action:"deselect_node",node:a,selected:this._data.core.selected}),void 0):!1},deselect_all:function(b){this._data.core.selected=a();var c=this.element.find(".jstree-clicked").removeClass("jstree-clicked");this.trigger("deselect_all",{selected:this._data.core.selected,node:c}),b||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,node:c})},is_selected:function(a){return a=this.get_node(a),a&&a.length?this._data.core.selected.index(a)>=0:!1},get_selected:function(){return this._data.core.selected},clean_node:function(b){b=this.get_node(b),b=b&&-1!==b?b.find("li").addBack():this.element.find("li"),b.find("li.jstree-clicked").removeClass("jstree-clicked"),this.settings.core.aria_roles&&b.attr("role","treeitem").parent().attr("role","group");var c=this;return b.each(function(){var b=a(this),d=b.children("a"),e=b.data("jstree"),f=e&&e.opened||b.hasClass("jstree-open")?"open":e&&(e.closed||e.children)||b.children("ul").length?"closed":"leaf";switch(e&&e.opened&&delete e.opened,e&&e.closed&&delete e.closed,b.removeClass("jstree-open jstree-closed jstree-leaf jstree-last"),d.length?a.trim(d.attr("href"))||d.attr("href","#"):(b.contents().filter(function(){return 3===this.nodeType||"UL"!==this.tagName}).wrapAll('<a href="#"></a>'),d=b.children("a"),d.html(b.children("a").html().replace(/[\s\t\n]+$/,""))),d.addClass("jstree-anchor"),b.children("i.jstree-ocl").length||b.prepend("<i class='jstree-icon jstree-ocl'>&#160;</i>"),b.next().length||b.addClass("jstree-last"),f){case"leaf":b.addClass("jstree-leaf");break;case"closed":b.addClass("jstree-closed"),c.close_node(b,0);break;case"open":b.addClass("jstree-closed"),c.open_node(b,!1,0)}d.children("i.jstree-themeicon").length||d.prepend("<i class='jstree-icon jstree-themeicon'>&#160;</i>"),e&&void 0!==e.icon&&(c.set_icon(b,e.icon),delete e.icon),e&&e.selected&&(c.select_node(b,!0,!0),delete e.selected),e&&e.disabled&&(c.disable_node(b),delete e.disabled)})},correct_node:function(b,c){return b=this.get_node(b),!b||-1===b&&!c?!1:(b=-1===b?this.element.find("li"):c?b.find("li").addBack():b,b.each(function(){var b=a(this);switch(!0){case b.hasClass("jstree-open")&&!b.children("ul").children("li").length:b.removeClass("jstree-open").addClass("jstree-leaf").children("ul").remove();break;case b.hasClass("jstree-leaf")&&!!b.children("ul").children("li").length:b.removeClass("jstree-leaf").addClass("jstree-closed")}b[0===b.next().length?"addClass":"removeClass"]("jstree-last")}),b)},get_state:function(){var a={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},themes:{name:this.get_theme(),icons:this._data.core.themes.icons,dots:this._data.core.themes.dots},selected:[]}};return this.get_container_ul().find(".jstree-open").each(function(){this.id&&a.core.open.push(this.id)}),this._data.core.selected.each(function(){this.id&&a.core.selected.push(this.id)}),a},set_state:function(b,c){if(b){if(b.core){if(a.isArray(b.core.open)){var d=!0,e=this;return a.each(b.core.open.concat([]),function(c,f){f=document.getElementById(f),f&&(e.is_loaded(f)?(e.is_closed(f)&&e.open_node(f,!1,0),a.vakata.array_remove(b.core.open,c)):(e.is_loading(f)||e.open_node(f,a.proxy(function(){this.set_state(b)},e),0),d=!1))}),d&&(delete b.core.open,this.set_state(b,c)),!1}if(b.core.scroll)return b.core.scroll&&void 0!==b.core.scroll.left&&this.element.scrollLeft(b.core.scroll.left),b.core.scroll&&void 0!==b.core.scroll.top&&this.element.scrollTop(b.core.scroll.top),delete b.core.scroll,delete b.core.open,this.set_state(b,c),!1;if(b.core.themes)return b.core.themes.name&&this.set_theme(b.core.themes.name),void 0!==b.core.themes.dots&&this[b.core.themes.dots?"show_dots":"hide_dots"](),void 0!==b.core.themes.icons&&this[b.core.themes.icons?"show_icons":"hide_icons"](),delete b.core.themes,delete b.core.open,this.set_state(b,c),!1;if(b.core.selected){var f=this;return this.deselect_all(),a.each(b.core.selected,function(a,b){f.select_node(document.getElementById(b))}),delete b.core.selected,this.set_state(b,c),!1}return a.isEmptyObject(b)?(c&&c.call(this),this.trigger("set_state"),!1):!0}return!0}return!1},refresh:function(){this._data.core.state=this.get_state(),this.load_node(-1,function(b,c){c&&this.set_state(a.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")}),this._data.core.state=null})},get_text:function(b,c){return b=this.get_node(b),b&&-1!==b&&b.length?(b=b.children("a:eq(0)").clone(),b.children(".jstree-icon").remove(),b=b[c?"text":"html"](),b=a("<div />")[c?"text":"html"](b),b.html()):!1},set_text:function(a,b){if(a=this.get_node(a),!a||-1===a||!a.length)return!1;a=a.children("a:eq(0)");var c=a.children("I").clone();return a.html(b).prepend(c),this.trigger("set_text",{obj:a,text:b}),!0},parse_json:function(b){var c,d,e,f;return null===b||a.isArray(b)&&0===b.length?!1:a.isArray(b)?(e=a("<ul />"),f=this,a.each(b,function(a,b){e.append(f.parse_json(b))}),e):(void 0===b&&(b={}),"string"==typeof b&&(b={title:b}),b.li_attr||(b.li_attr={}),b.a_attr||(b.a_attr={}),b.a_attr.href||(b.a_attr.href="#"),b.title||(b.title=this.get_string("New node")),c=a("<li />").attr(b.li_attr),d=a("<a />").attr(b.a_attr).html(b.title),e=a("<ul />"),b.data&&!a.isEmptyObject(b.data)&&c.data(b.data),(b.children===!0||a.isArray(b.children)||c.data("jstree")&&a.isArray(c.data("jstree").children))&&(c.data("jstree")||c.data("jstree",{}),c.data("jstree").closed=!0),c.append(d),a.isArray(b.children)&&(a.each(b.children,a.proxy(function(a,b){e.append(this.parse_json(b))},this)),c.append(e)),c)},get_json:function(b,c){b=void 0!==b?this.get_node(b):!1,c||b&&-1!==b||(b=this.get_container_ul().children("li"));var d,e,f,g={},h={},i={};return b&&b.length?b.length>1||!c?(d=[],e=this,b.each(function(){d.push(e.get_json(a(this),!0))}),d):(i=a.vakata.attributes(b,!0),a.each(i,function(b,c){return"id"===b?(g[b]=c,!0):(c=a.trim(c.replace(/\bjstree[^ ]*/gi,"").replace(/\s+$/gi," ")),c.length&&(g[b]=c),void 0)}),i=a.vakata.attributes(b.children(".jstree-anchor"),!0),a.each(i,function(b,c){return"id"===b?(h[b]=c,!0):(c=a.trim(c.replace(/\bjstree[^ ]*/gi,"").replace(/\s+$/gi," ")),c.length&&(h[b]=c),void 0)}),d={title:this.get_text(b),data:a.extend(!0,{},b.data()||{}),children:!1,li_attr:g,a_attr:h},d.data.jstree||(d.data.jstree={}),this.is_open(b)&&(d.data.jstree.opened=!0),this.is_closed(b)&&(d.data.jstree.closed=!0),f=this.get_icon(b),void 0!==f&&null!==f&&(d.data.jstree.icon=f),this.is_selected(b)&&(d.data.jstree.selected=!0),b=b.children("ul").children("li"),b.length&&(d.children=[],e=this,b.each(function(){d.children.push(e.get_json(a(this),!0))})),d):!1},create_node:function(a,b,c,d,e){if(a=this.get_node(a),c=void 0===c?"last":c,-1!==a&&!a.length)return!1;if(!c.match(/^(before|after)$/)&&!e&&!this.is_loaded(a))return this.load_node(a,function(){this.create_node(a,b,c,d,!0)});var f=this.parse_json(b),g=-1===a?this.element:a;switch(-1===a&&("before"===c&&(c="first"),"after"===c&&(c="last")),c){case"before":c=a.index(),a=this.get_parent(a);break;case"after":c=a.index()+1,a=this.get_parent(a);break;case"inside":case"first":c=0;break;case"last":c=g.children("ul").children("li").length;break;default:c||(c=0)}return this.check("create_node",f,a,c)?(g=-1===a?this.element:a,g.children("ul").length||g.append("<ul />"),g.children("ul").children("li").eq(c).length?g.children("ul").children("li").eq(c).before(f):g.children("ul").append(f),this.correct_node(a,!0),d&&d.call(this,f),this.trigger("create_node",{node:f,parent:a,position:f.index()}),f):!1},rename_node:function(a,b){a=this.get_node(a);var c=this.get_text(a);return this.check("rename_node",a,this.get_parent(a),b)?(a&&a.length&&(this.set_text(a,b),this.trigger("rename_node",{node:a,title:b,old:c})),void 0):!1},delete_node:function(a){if(a=this.get_node(a),!a||-1===a||!a.length)return!1;var b=this.get_parent(a),c=this.get_prev(a);if(!this.check("delete_node",a,b,a.index()))return!1;a=a.detach(),this.correct_node(b),this.correct_node(c),this.trigger("delete_node",{node:a,prev:c,parent:b});var d=a.find(".jstree-clicked"),e=this;return d.length&&(d.each(function(){e.deselect_node(this,!0)}),this.trigger("changed",{action:"delete_node",node:a,selected:this._data.core.selected,parent:b})),a},check:function(b,c,d,e){var f=b.match(/^move_node|copy_node|create_node$/i)?d:c,g=this.settings.core.check_callback;if(g===!1||a.isFunction(g)&&g.call(this,b,c,d,e)===!1)return!1;if(f=-1===f?this.element.data("jstree"):f.data("jstree"),f&&f.functions&&f.functions[b]&&(f=f.functions[b],a.isFunction(f)&&(f=f.call(this,b,c,d,e)),f===!1))return!1;switch(b){case"create_node":break;case"rename_node":break;case"move_node":if(f=-1===d?this.element:d,f=f.children("ul").children("li"),f.length&&-1!==f.index(c)&&(e===c.index()||e===c.index()+1))return!1;if(-1!==d&&-1!==d.parentsUntil(".jstree","li").addBack().index(c))return!1;break;case"copy_node":break;case"delete_node":}return!0},move_node:function(b,c,d,e,f){if(b=this.get_node(b),c=this.get_node(c),d=void 0===d?0:d,!b||-1===b||!b.length)return!1;if(-1!==c&&!c.length)return!1;if(!(""+d).match(/^(before|after)$/)&&!f&&!this.is_loaded(c))return this.load_node(c,function(){this.move_node(b,c,d,e,!0)});var g=this.get_parent(b),h=(""+d).match(/^(before|after)$/)&&-1!==c?this.get_parent(c):c,i=a.jstree.reference(b),j=-1===c?this:a.jstree.reference(c),k=i._id!==j._id;switch(-1===h&&(c=j.get_container(),"before"===d&&(d="first"),"after"===d&&(d="last")),d){case"before":d=c.index();break;case"after":d=c.index()+1;break;case"inside":case"first":d=0;break;case"last":d=c.children("ul").children("li").length;break;default:d||(d=0)}return this.check("move_node",b,h,d)?(c.children("ul").length||c.append("<ul />"),c.children("ul").children("li").eq(d).length?c.children("ul").children("li").eq(d).before(b):c.children("ul").append(b),k&&(b.find(".jstree-icon, .jstree-ocl").remove(),this.clean_node(b)),i.correct_node(g,!0),j.correct_node(h,!0),e&&e.call(this,b,h,b.index()),this.trigger("move_node",{node:b,parent:h,position:b.index(),old_parent:g,is_multi:k,old_instance:i,new_instance:j}),!0):!1},copy_node:function(b,c,d,e,f){if(b=this.get_node(b),c=this.get_node(c),d=void 0===d?"last":d,!b||-1===b||!b.length)return!1;if(-1!==c&&!c.length)return!1;if(!(""+d).match(/^(before|after)$/)&&!f&&!this.is_loaded(c))return this.load_node(c,function(){this.copy_node(b,c,d,e,!0)});var g=b,h=this.get_parent(b),i=(""+d).match(/^(before|after)$/)&&-1!==c?this.get_parent(c):c,j=a.jstree.reference(b),k=-1===c?this:a.jstree.reference(c),l=j._id!==k._id;switch(b=b.clone(!0),b.find("*[id]").addBack().each(function(){this.id&&(this.id="copy_"+this.id)}),-1===i&&(c=k.get_container(),"before"===d&&(d="first"),"after"===d&&(d="last")),d){case"before":d=c.index();break;case"after":d=c.index()+1;break;case"inside":case"first":d=0;break;case"last":d=c.children("ul").children("li").length;break;default:d||(d=0)}return this.check("copy_node",g,i,d)?(c.children("ul").length||c.append("<ul />"),c.children("ul").children("li").eq(d).length?c.children("ul").children("li").eq(d).before(b):c.children("ul").append(b),l&&b.find(".jstree-icon, .jstree-ocl").remove(),k.clean_node(b),k.correct_node(i,!0),e&&e.call(this,b,i,b.index(),g),this.trigger("copy_node",{node:b,parent:i,old_parent:h,position:b.index(),original:g,is_multi:l,old_instance:j,new_instance:k}),!0):!1},cut:function(a){return a=this.get_node(a),a&&-1!==a&&a.length?(c=a,d="move_node",this.trigger("cut",{node:a}),void 0):!1},copy:function(a){return a=this.get_node(a),a&&-1!==a&&a.length?(c=a,d="copy_node",this.trigger("copy",{node:a}),void 0):!1},get_buffer:function(){return{mode:d,node:c}},can_paste:function(){return d!==!1&&c!==!1},paste:function(a){return a=this.get_node(a),a&&d&&d.match(/^(copy_node|move_node)$/)&&c?(this[d](c,a),this.trigger("paste",{obj:a,nodes:c,mode:d}),c=!1,d=!1,void 0):!1},edit:function(b,c){if(b=this.get_node(b),!b||-1===b||!b.length)return!1;b.parentsUntil(".jstree",".jstree-closed").each(a.proxy(function(a,b){this.open_node(b,!1,0)},this));var d=this._data.core.rtl,e=this.element.width(),f=b.children("a:eq(0)"),g=b.children("i"),h=f.children("i"),i=g.width()*g.length,j=h.width()*h.length,k="string"==typeof c?c:this.get_text(b),l=a("<div />",{css:{position:"absolute",top:"-200px",left:d?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),m=b.css("position","relative").append(a("<input />",{value:k,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:d?"auto":i+j+4+"px",right:d?i+j+4+"px":"auto",top:"0px",height:this._data.core.li_height-2+"px",lineHeight:this._data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=b.children(".jstree-rename-input"),c=a.val();""===c&&(c=k),l.remove(),a.remove(),this.rename_node(b,c)===!1&&this.rename_node(b,k),b.css("position","")},this),keydown:function(a){var b=a.keyCode||a.which;27===b&&(this.value=k),(27===b||13===b||37===b||38===b||39===b||40===b)&&a.stopImmediatePropagation(),(27===b||13===b)&&(a.preventDefault(),this.blur())},keyup:function(a){a.keyCode||a.which,m.width(Math.min(l.text("pW"+this.value).width(),e))},keypress:function(a){var b=a.keyCode||a.which;return 13===b?!1:void 0}})).children(".jstree-rename-input"),n={fontFamily:f.css("fontFamily")||"",fontSize:f.css("fontSize")||"",fontWeight:f.css("fontWeight")||"",fontStyle:f.css("fontStyle")||"",fontStretch:f.css("fontStretch")||"",fontVariant:f.css("fontVariant")||"",letterSpacing:f.css("letterSpacing")||"",wordSpacing:f.css("wordSpacing")||""};this.set_text(b,""),l.css(n),m.css(n).width(Math.min(l.text("pW"+m[0].value).width(),e))[0].select()},set_theme:function(b,c){if(!b)return!1;if(c===!0){var d=this.settings.core.themes.dir;d||(d=a.jstree.path+"/themes"),c=d+"/"+b+"/style.css"}c&&-1===a.inArray(c,e)&&(a("head").append('<link rel="stylesheet" href="'+c+'" type="text/css" />'),e.push(c)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=b,this.element.addClass("jstree-"+b),this.trigger("set_theme",{theme:b})},get_theme:function(){return this._data.core.themes.name},show_dots:function(){this._data.core.themes.dots=!0,this.element.children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.element.children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.element.children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.element.children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(a,b){return a=this.get_node(a),a&&-1!==a&&a.length?(a=a.children("a").children(".jstree-themeicon"),b===!1?this.hide_icon(a):-1===b.indexOf("/")?a.addClass(b).attr("rel",b):a.css("background","url('"+b+"') center center no-repeat").attr("rel",b),!0):!1},get_icon:function(a){return a=this.get_node(a),a&&-1!==a&&a.length?(a=a.children("a").children(".jstree-themeicon"),a.hasClass("jstree-themeicon-hidden")?!1:(a=a.attr("rel"),a&&a.length?a:null)):null},hide_icon:function(a){return a=this.get_node(a),a&&-1!==a&&a.length?(a.children("a").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0):!1},show_icon:function(a){return a=this.get_node(a),a&&-1!==a&&a.length?(a.children("a").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0):!1}};var f=a("script:last").attr("src");a.jstree.path=f?f.replace(/\/[^\/]+$/,""):"",a.jstree.no_css=f&&-1!==f.indexOf("?no_css"),a.jstree.no_css&&(a.jstree.defaults.core.themes.url=!1),a(function(){var b=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; list-style-image:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree .jstree-icon { display:inline-block; text-decoration:none; margin:0; padding:0; vertical-align:top; } .jstree .jstree-ocl { width:18px; height:18px; text-align:center; line-height:18px; cursor:pointer; vertical-align:top; } .jstree li.jstree-open > ul { display:block; } .jstree li.jstree-closed > ul { display:none; } .jstree-anchor { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; padding:1px 4px 1px 2px; margin:0; text-decoration:none; outline:0; } .jstree-anchor > .jstree-themeicon { height:16px; width:16px; margin-right:3px; } .jstree-rtl .jstree-anchor { padding:1px 2px 1px 4px; } .jstree-rtl .jstree-anchor > .jstree-themeicon { margin-left:3px; margin-right:0; } .jstree-no-icons .jstree-themeicon, .jstree-anchor > .jstree-themeicon-hidden { display:none; } ";a.jstree.no_css||a("head").append('<style type="text/css">'+b+"<"+"/style>")}),a.vakata={},a.vakata.attributes=function(b,c){b=a(b)[0];var d=c?{}:[];return a.each(b.attributes,function(b,e){-1===a.inArray(e.nodeName.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==e.nodeValue&&""!==a.trim(e.nodeValue)&&(c?d[e.nodeName]=e.nodeValue:d.push(e.nodeName))}),d},a.vakata.array_remove=function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=0>b?a.length+b:b,a.push.apply(a,d),a};var g=function(a){var b=/["\\\x00-\x1f\x7f-\x9f]/g,c={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return a.match(b)?'"'+a.replace(b,function(a){var b=c[a];return"string"==typeof b?b:(b=a.charCodeAt(),"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16))})+'"':'"'+a+'"'};a.vakata.json={encode:function(b){if(null===b)return"null";var c,d=[];switch(typeof b){case"undefined":return void 0;case"number":case"boolean":return b+"";case"string":return g(b);case"object":if(a.isFunction(b.toJSON))return a.vakata.json.encode(b.toJSON());if(b.constructor===Date)return'"'+b.getUTCFullYear()+"-"+("0"+(b.getUTCMonth()+1)).slice(-2)+"-"+("0"+b.getUTCDate()).slice(-2)+"T"+("0"+b.getUTCHours()).slice(-2)+":"+("0"+b.getUTCMinutes()).slice(-2)+":"+("0"+b.getUTCSeconds()).slice(-2)+"."+("00"+b.getUTCMilliseconds()).slice(-3)+'Z"';if(b.constructor===Array){for(c=0;b.length>c;c++)d.push(a.vakata.json.encode(b[c])||"null");return"["+d.join(",")+"]"}return a.each(b,function(b,c){return a.isFunction(c)?!0:(b="number"==typeof b?'"'+b+'"':g(b),c=a.vakata.json.encode(c),d.push(b+":"+c),void 0)}),"{"+d.join(", ")+"}"}},decode:function(b){return a.parseJSON(b)}}}}(jQuery),function(a){a.jstree.defaults.checkbox={three_state:!0,whole_node:!1,keep_selected_style:!0,icons:!0,parse_data:!0},a.jstree.plugins.checkbox=function(b,c){this.bind=function(){c.bind.call(this),this.element.on("init.jstree",a.proxy(function(){this._data.checkbox.icons=this.settings.checkbox.icons},this)).on("loaded.jstree",a.proxy(function(){this[this._data.checkbox.icons?"show_checkboxes":"hide_checkboxes"]()},this)),this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.three_state&&this.element.on("ready.jstree",a.proxy(function(){var b=!1,c=this.get_selected(),d=c.find(".jstree-undetermined").removeClass("jstree-undetermined").end().find(".jstree-anchor:not(.jstree-clicked)");d.length&&(b=!0,this.select_node(d,!0,!0)),c.each(a.proxy(function(c,d){b=b||this.check_up(a(d).parent())},this)),b&&this.trigger("changed",{action:"checkbox_three_state",selected:this._data.core.selected}),this.settings.json&&this.settings.json.progressive_render&&this.settings.checkbox.three_state&&this.element.on("deselect_all.jstree select_node.jstree deselect_node.jstree",a.proxy(function(b,c){c.node.filter(".jstree-closed").each(a.proxy(function(c,d){var e=a(d),f=e.data("jstree");f&&f.children&&0===e.children("ul").length&&this._progressive_data_clean(f.children,"select_node"===b.type)},this))},this))},this)).on("deselect_all.jstree",a.proxy(function(){this.element.find(".jstree-undetermined").removeClass("jstree-undetermined")},this)).on("open_node.jstree",a.proxy(function(a,b){if(b.node&&-1!==b.node){var c;this.is_selected(b.node)?(c=b.node.find(".jstree-anchor").not(".jstree-clicked"),c.length&&this.select_node(c,!0,!0)):this.check_up(b.node)&&this.trigger("changed",{action:"checkbox_three_state",selected:this._data.core.selected})}},this)).on("changed.jstree",a.proxy(function(a,b){var c,d=b.action||"",e=!1,f=!1;switch(d){case"select_node":e=b.node.parent(),c=b.node.find(".jstree-anchor:not(.jstree-clicked)"),c.length&&(f=!0,this.select_node(c,!0,!0)),b.node.find(".jstree-undetermined").removeClass("jstree-undetermined");break;case"deselect_node":e=b.node.parent(),c=b.node.find(".jstree-clicked"),c.length&&(f=!0,this.deselect_node(c,!0)),b.node.find(".jstree-undetermined").removeClass("jstree-undetermined");break;case"deselect_all":this.element.find(".jstree-undetermined").removeClass("jstree-undetermined");break;case"delete_node":e=b.parent}e&&this.check_up(e)&&(f=!0),f&&this.trigger("changed",{action:"checkbox_three_state",selected:this._data.core.selected})},this)).on("move_node.jstree copy_node.jstree",a.proxy(function(a,b){b.old_instance&&b.old_instance.check_up&&b.old_instance.check_up(b.old_parent)&&b.old_instance.trigger("changed",{action:"checkbox_three_state",selected:b.old_instance._data.core.selected}),b.new_instance&&b.new_instance.check_up&&b.new_instance.check_up(b.parent)&&b.new_instance.trigger("changed",{action:"checkbox_three_state",selected:b.new_instance._data.core.selected})},this))},this._progressive_data_clean=function(a,b){if(!this.settings.checkbox.three_state)return!1;for(var c=0,d=a.length;d>c;c++)a[c].data&&a[c].data.jstree&&(a[c].data.jstree.selected&&delete a[c].data.jstree.selected,a[c].data.jstree.undetermined&&delete a[c].data.jstree.undetermined,a[c].children&&this._progressive_data_clean(a[c].children,b))},this._set_state=function(b){var c=0,d=0,e=0,f=!1;if(a.isArray(b)){for(c=0,d=b.length;d>c;c++)b[c]=this._set_state(b[c]);return b}if(void 0===b&&(b={}),"string"==typeof b&&(b={title:b}),b.data||(b.data={}),b.data.jstree||(b.data.jstree={}),f=b.data.jstree,f.selected||f.undetermined||f._checkboxed)return b;if(f._checkboxed=!0,b.children&&b.children.length){for(c=0,d=b.children.length;d>c;c++)b.children[c]=this._set_state(b.children[c]),f=b.children[c].data.jstree,f.selected?e+=2:f.undetermined&&(e+=1);e>0&&(e===2*d?b.data.jstree.selected=!0:b.data.jstree.undetermined=!0)}return b},this.parse_json=function(b){var d=this.settings.checkbox;return d.parse_data&&d.three_state&&a.isArray(b)&&(b=this._set_state(b)),c.parse_json.call(this,b)},this.clean_node=function(b){return b=c.clean_node.call(this,b),b.each(function(){var b=a(this),c=b.data("jstree"),d=b.children("a");d.children("i.jstree-checkbox").length||d.prepend("<i class='jstree-icon jstree-checkbox'></i>"),c&&c.undetermined&&(d.parentsUntil(".jstree","li").children("a.jstree-anchor").children("i.jstree-checkbox").addClass("jstree-undetermined"),delete c.undetermined)})},this.get_json=function(a,b){var d=c.get_json.call(this,a,b);return b&&a.children(".jstree-anchor").children(".jstree-undetermined").length&&(d.data.jstree.undetermined=!0),d},this.activate_node=function(b,d){(this.settings.checkbox.whole_node||a(d.target).hasClass("jstree-checkbox"))&&(d.ctrlKey=!0),c.activate_node.call(this,b,d)},this.check_up=function(a){if(!this.settings.checkbox.three_state)return!1;if(a=this.get_node(a),-1===a||!a||!a.length)return!1;var b=0,c=a.children("ul").children("li").length>0,d=c&&0===a.children("ul").children("li").not(this._data.core.selected).length,e=c&&0===a.find("li > .jstree-clicked, li > .jstree-anchor > .jstree-undetermined").length;if(!b&&this.is_selected(a)&&(b=1),!b&&a.children(".jstree-anchor").children(".jstree-undetermined").length&&(b=2),!c)return 2===b&&a.find(".jstree-undetermined").removeClass("jstree-undetermined"),!1;if(d)return 1!==b&&(a.find(".jstree-undetermined").removeClass("jstree-undetermined"),this.select_node(a,!0),this.check_up(a.parent())),!0;if(e)return 2===b?(a.find(".jstree-undetermined").removeClass("jstree-undetermined"),this.check_up(a.parent()),!1):1===b?(this.deselect_node(a,!0),this.check_up(a.parent()),!0):!1;if(1===b)return a.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"),this.deselect_node(a,!0),this.check_up(a.parent()),!0;if(0===b){var f=a.children(".jstree-anchor").children(".jstree-checkbox");f.hasClass("jstree-undetermined")||(a.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"),this.check_up(a.parent()))}return!1},this.show_checkboxes=function(){this._data.checkbox.icons=!0,this.element.children("ul").removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.checkbox.icons=!1,this.element.children("ul").addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.checkbox.icons?this.hide_checkboxes():this.show_checkboxes()}},a(function(){var b=".jstree-anchor > .jstree-checkbox { height:16px; width:16px; margin-right:1px; } .jstree-rtl .jstree-anchor > .jstree-checkbox { margin-right:0; margin-left:1px; } ";a.jstree.no_css||a("head").append('<style type="text/css">'+b+"</style>")}),a.jstree.defaults.plugins.push("checkbox")}(jQuery),function(a){a.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(){return{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.create_node(d,{},"last",function(a){setTimeout(function(){c.edit(a)},0)})}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.edit(d)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.delete_node(d)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.cut(d)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.copy(d)}},paste:{separator_before:!1,icon:!1,_disabled:!this.can_paste(),separator_after:!1,label:"Paste",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.paste(d)}}}}}}},a.jstree.plugins.contextmenu=function(b,c){this.bind=function(){c.bind.call(this),this.element.on("contextmenu.jstree","a",a.proxy(function(a){a.preventDefault(),this.is_loading(a.currentTarget)||this.show_contextmenu(a.currentTarget,a.pageX,a.pageY)},this)).on("click.jstree","a",a.proxy(function(){this._data.contextmenu.visible&&a.vakata.context.hide()},this)),a(document).on("context_hide.vakata",a.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&a.vakata.context.hide(),c.teardown.call(this)},this.show_contextmenu=function(b,c,d){b=this.get_node(b);var e=this.settings.contextmenu,f=b.children("a:visible:eq(0)"),g=!1,h=!1;(e.show_at_node||void 0===c||void 0===d)&&(g=f.offset(),c=g.left,d=g.top+this._data.core.li_height),this.is_selected(b)||(this.deselect_all(),this.select_node(b)),h=b.data("jstree")&&b.data("jstree").contextmenu?b.data("jstree").contextmenu:e.items,a.isFunction(h)&&(h=h.call(this,b)),a(document).one("context_show.vakata",a.proxy(function(b,c){var d="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";a(c.element).addClass(d)},this)),this._data.contextmenu.visible=!0,a.vakata.context.show(f,{x:c,y:d},h),this.trigger("show_contextmenu",{node:b,x:c,y:d})
}},function(a){var b=!1,c={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};a.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(b){a(document).triggerHandler("context_"+b+".vakata",{reference:c.reference,element:c.element,position:{x:c.position_x,y:c.position_y}})},_execute:function(a){return a=c.items[a],a&&!a._disabled&&a.action?a.action.call(null,{item:a,reference:c.reference,element:c.element,position:{x:c.position_x,y:c.position_y}}):!1},_parse:function(b,d){if(!b)return!1;d||(c.html="",c.items=[]);var e,f="",g=!1;return d&&(f+="<ul>"),a.each(b,function(b,d){return d?(c.items.push(d),!g&&d.separator_before&&(f+="<li class='vakata-context-separator'><a href='#' "+(a.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<"+"/a><"+"/li>"),g=!1,f+="<li class='"+(d._class||"")+(d._disabled?" vakata-contextmenu-disabled ":"")+"'>",f+="<a href='#' rel='"+(c.items.length-1)+"'>",a.vakata.context.settings.icons&&(f+="<ins ",d.icon&&(f+=-1!==d.icon.indexOf("/")?" style='background:url(\""+d.icon+"\") center center no-repeat' ":" class='"+d.icon+"' "),f+=">&#160;</ins><span>&#160;</span>"),f+=d.label+"<"+"/a>",d.submenu&&(e=a.vakata.context._parse(d.submenu,!0),e&&(f+=e)),f+="</li>",d.separator_after&&(f+="<li class='vakata-context-separator'><a href='#' "+(a.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<"+"/a><"+"/li>",g=!0),void 0):!0}),f=f.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),d&&(f+="</ul>"),d||(c.html=f,a.vakata.context._trigger("parse")),f.length>10?f:!1},_show_submenu:function(c){if(c=a(c),c.length&&c.children("ul").length){var d=c.children("ul"),e=c.offset().left+c.outerWidth(),f=c.offset().top,g=d.width(),h=d.height(),i=a(window).width()+a(window).scrollLeft(),j=a(window).height()+a(window).scrollTop();b?c[0>e-(g+10+c.outerWidth())?"addClass":"removeClass"]("vakata-context-left"):c[e+g+10>i?"addClass":"removeClass"]("vakata-context-right"),f+h+10>j&&d.css("bottom","-1px"),d.show()}},show:function(d,e,f){switch(c.element&&c.element.length&&c.element.width(""),!0){case!e&&!d:return!1;case!!e&&!!d:c.reference=d,c.position_x=e.x,c.position_y=e.y;break;case!e&&!!d:c.reference=d;var g=d.offset();c.position_x=g.left+d.outerHeight(),c.position_y=g.top;break;case!!e&&!d:c.position_x=e.x,c.position_y=e.y}if(d&&!f&&a(d).data("vakata_contextmenu")&&(f=a(d).data("vakata_contextmenu")),a.vakata.context._parse(f)&&c.element.html(c.html),c.items.length){var h=c.element,i=c.position_x,j=c.position_y,k=h.width(),l=h.height(),m=a(window).width()+a(window).scrollLeft(),n=a(window).height()+a(window).scrollTop();b&&(i-=h.outerWidth(),a(window).scrollLeft()+20>i&&(i=a(window).scrollLeft()+20)),i+k+20>m&&(i=m-(k+20)),j+l+20>n&&(j=n-(l+20)),c.element.css({left:i,top:j}).show().find("a:eq(0)").focus().parent().addClass("vakata-context-hover"),c.is_visible=!0,a.vakata.context._trigger("show")}},hide:function(){c.is_visible&&(c.element.hide().find("ul").hide().end().find(":focus").blur(),c.is_visible=!1,a.vakata.context._trigger("hide"))}},a(function(){b="rtl"===a("body").css("direction");var d=!1,e='.vakata-context { display:none; _width:1px; } .vakata-context, .vakata-context ul { margin:0; padding:2px; position:absolute; background:#f5f5f5; border:1px solid #979797; 	-moz-box-shadow:5px 5px 4px -4px #666666; -webkit-box-shadow:2px 2px 2px #999999; box-shadow:2px 2px 2px #999999; }.vakata-context ul { list-style:none; left:100%; margin-top:-2.7em; margin-left:-4px; } .vakata-context li.vakata-context-right ul { left:auto; right:100%; margin-left:auto; margin-right:-4px; } .vakata-context li { list-style:none; display:inline; }.vakata-context li a { display:block; padding:0 2em 0 2em; text-decoration:none; width:auto; color:black; white-space:nowrap; line-height:2.4em; 	-moz-text-shadow:1px 1px 0px white; -webkit-text-shadow:1px 1px 0px white; text-shadow:1px 1px 0px white; 	-moz-border-radius:1px; -webkit-border-radius:1px; border-radius:1px; }.vakata-context li a:hover { position:relative; background-color:#e8eff7; 	-moz-box-shadow:0px 0px 2px #0a6aa1; -webkit-box-shadow:0px 0px 2px #0a6aa1; box-shadow:0px 0px 2px #0a6aa1; }.vakata-context li.vakata-context-hover > a { position:relative; background-color:#e8eff7; 	-moz-box-shadow:0px 0px 2px #0a6aa1; -webkit-box-shadow:0px 0px 2px #0a6aa1; box-shadow:0px 0px 2px #0a6aa1; }.vakata-context li a.vakata-context-parent { background-image:url("data:image/gif;base64,R0lGODlhCwAHAIAAACgoKP///yH5BAEAAAEALAAAAAALAAcAAAIORI4JlrqN1oMSnmmZDQUAOw=="); background-position:right center; background-repeat:no-repeat; } .vakata-context li.vakata-context-separator a, .vakata-context li.vakata-context-separator a:hover { background:white; border:0; border-top:1px solid #e2e3e3; height:1px; min-height:1px; max-height:1px; padding:0; margin:0 0 0 2.4em; border-left:1px solid #e0e0e0; _overflow:hidden; 	-moz-text-shadow:0 0 0 transparent; -webkit-text-shadow:0 0 0 transparent; text-shadow:0 0 0 transparent; 	-moz-box-shadow:0 0 0 transparent; -webkit-box-shadow:0 0 0 transparent; box-shadow:0 0 0 transparent; 	-moz-border-radius:0; -webkit-border-radius:0; border-radius:0; }.vakata-context li.vakata-contextmenu-disabled a, .vakata-context li.vakata-contextmenu-disabled a:hover { color:silver; background-color:transparent; border:0; box-shadow:0 0 0; }.vakata-context li a ins { text-decoration:none; display:inline-block; width:2.4em; height:2.4em; background:transparent; margin:0 0 0 -2em; } .vakata-context li a span { display:inline-block; width:1px; height:2.4em; background:white; margin:0 0.5em 0 0; border-left:1px solid #e2e3e3; _overflow:hidden; } .vakata-context-rtl ul { left:auto; right:100%; margin-left:auto; margin-right:-4px; } .vakata-context-rtl li a.vakata-context-parent { background-image:url("data:image/gif;base64,R0lGODlhCwAHAIAAACgoKP///yH5BAEAAAEALAAAAAALAAcAAAINjI+AC7rWHIsPtmoxLAA7"); background-position:left center; background-repeat:no-repeat; } .vakata-context-rtl li.vakata-context-separator a { margin:0 2.4em 0 0; border-left:0; border-right:1px solid #e2e3e3;} .vakata-context-rtl li.vakata-context-left ul { right:auto; left:100%; margin-left:-4px; margin-right:auto; } .vakata-context-rtl li a ins { margin:0 -2em 0 0; } .vakata-context-rtl li a span { margin:0 0 0 0.5em; border-left-color:white; background:#e2e3e3; } ';a.jstree.no_css||a("head").append('<style type="text/css">'+e+"</style>"),c.element=a("<ul class='vakata-context'></ul>"),c.element.on("mouseenter","li",function(b){b.stopImmediatePropagation(),a.contains(this,b.relatedTarget)||(d&&clearTimeout(d),c.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),a(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),a.vakata.context._show_submenu(this))}).on("mouseleave","li",function(b){a.contains(this,b.relatedTarget)||a(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(){a(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),a.vakata.context.settings.hide_onmouseleave&&(d=setTimeout(function(){return function(){a.vakata.context.hide()}}(this),a.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(a){a.preventDefault()}).on("mouseup","a",function(){a(this).blur().parent().hasClass("vakata-context-disabled")||a.vakata.context._execute(a(this).attr("rel"))===!1||a.vakata.context.hide()}).on("keydown","a",function(b){var d=null;switch(b.which){case 13:case 32:b.type="mouseup",b.preventDefault(),a(b.currentTarget).trigger(b);break;case 37:c.is_visible&&(c.element.find(".vakata-context-hover").last().parents("li:eq(0)").find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 38:c.is_visible&&(d=c.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),d.length||(d=c.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),d.addClass("vakata-context-hover").children("a").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 39:c.is_visible&&(c.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 40:c.is_visible&&(d=c.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),d.length||(d=c.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),d.addClass("vakata-context-hover").children("a").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 27:a.vakata.context.hide(),b.preventDefault()}}).appendTo("body"),a(document).on("mousedown",function(b){c.is_visible&&!a.contains(c.element[0],b.target)&&a.vakata.context.hide()}).on("context_show.vakata",function(){c.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),b&&c.element.addClass("vakata-context-rtl").css("direction","rtl"),c.element.find("ul").hide().end()})})}(a),a.jstree.defaults.plugins.push("contextmenu")}(jQuery),function(a){a.jstree.defaults.dnd={copy:!0,open_timeout:500},a.jstree.plugins.dnd=function(b,c){this.bind=function(){c.bind.call(this),this.element.on("mousedown","a",a.proxy(function(b){var c=this.get_node(b.target);return c&&-1!==c&&c.length&&1===b.which?(this.element.trigger("mousedown.jstree"),a.vakata.dnd.start(b,{jstree:!0,origin:this,obj:c},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+'"><i class="jstree-icon jstree-er"></i>'+this.get_text(b.currentTarget,!0)+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):void 0},this))}},a(function(){var b=!1,c=!1,d=a('<div id="jstree-marker">&#160;</div>').hide().appendTo("body");a(document).bind("dnd_start.vakata",function(){b=!1}).bind("dnd_move.vakata",function(e,f){if(c&&clearTimeout(c),f.data.jstree&&(!f.event.target.id||"jstree-marker"!==f.event.target.id)){var g,h,i,j,k,l,m=a.jstree.reference(f.event.target),n=!1,o=!1,p=!1;if(m&&m._data&&m._data.dnd)if(d.attr("class","jstree-"+m.get_theme()),f.helper.children().attr("class","jstree-"+m.get_theme()).find(".jstree-copy:eq(0)")[f.data.origin.settings.dnd.copy&&(f.event.metaKey||f.event.ctrlKey)?"show":"hide"](),f.event.target===m.element[0]||f.event.target===m.get_container_ul()[0]){if(m.check(f.data.origin.settings.dnd.copy&&(f.event.metaKey||f.event.ctrlKey)?"copy_node":"move_node",f.data.obj,-1,"last"))return b={ins:m,par:-1,pos:"last"},d.hide(),f.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok"),void 0}else if(n=a(f.event.target).closest("a"),n&&n.length&&n.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(o=n.offset(),p=f.event.pageY-o.top,i=n.height(),l=i/3>p?["b","i","a"]:p>i-i/3?["a","i","b"]:p>i/2?["i","a","b"]:["i","b","a"],a.each(l,function(a,e){switch(e){case"b":g=o.left-6,h=o.top-5,j=m.get_parent(n),k=n.parent().index();break;case"i":g=o.left-2,h=o.top-5+i/2+1,j=n.parent(),k=0;break;case"a":g=o.left-6,h=o.top-5+i+2,j=m.get_parent(n),k=n.parent().index()+1}return m.check(f.data.origin.settings.dnd.copy&&(f.event.metaKey||f.event.ctrlKey)?"copy_node":"move_node",f.data.obj,j,k)?("i"===e&&n.parent().is(".jstree-closed")&&m.settings.dnd.open_timeout&&(c=setTimeout(function(a,b){return function(){a.open_node(b)}}(m,n),m.settings.dnd.open_timeout)),b={ins:m,par:j,pos:k},d.css({left:g+"px",top:h+"px"}).show(),f.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok"),l=!0,!1):void 0}),l===!0))return;b=!1,f.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),d.hide()}}).bind("dnd_scroll.vakata",function(a,c){c.data.jstree&&(d.hide(),b=!1,c.helper.find(".jstree-icon:eq(0)").removeClass("jstree-ok").addClass("jstree-er"))}).bind("dnd_stop.vakata",function(a,e){c&&clearTimeout(c),e.data.jstree&&(d.hide(),b&&b.ins[e.data.origin.settings.dnd.copy&&(e.event.metaKey||e.event.ctrlKey)?"copy_node":"move_node"](e.data.obj,b.par,b.pos))}).bind("keyup keydown",function(b,c){c=a.vakata.dnd._get(),c.data&&c.data.jstree&&c.helper.find(".jstree-copy:eq(0)")[c.data.origin.settings.dnd.copy&&(b.metaKey||b.ctrlKey)?"show":"hide"]()});var e="#jstree-marker { position: absolute; top:0; left:0; margin:0; padding:0; border-right:0; border-top:5px solid transparent; border-bottom:5px solid transparent; border-left:5px solid; width:0; height:0; font-size:0; line-height:0; _border-top-color:pink; _border-botton-color:pink; _filter:chroma(color=pink); } #jstree-dnd { line-height:16px; margin:0; padding:4px; } #jstree-dnd .jstree-icon, #jstree-dnd .jstree-copy { display:inline-block; text-decoration:none; margin:0 2px 0 0; padding:0; width:16px; height:16px; } #jstree-dnd .jstree-ok { background:green; } #jstree-dnd .jstree-er { background:red; } #jstree-dnd .jstree-copy { margin:0 2px 0 2px; }";a.jstree.no_css||a("head").append('<style type="text/css">'+e+"</style>")}),a.jstree.defaults.plugins.push("dnd")}(jQuery),function(a){a.fn.vakata_reverse=[].reverse;var b={element:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1};a.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5},_trigger:function(b,c){var d=a.vakata.dnd._get();d.event=c,a(document).triggerHandler("dnd_"+b+".vakata",d)},_get:function(){return{data:b.data,element:b.element,helper:b.helper}},_clean:function(){b.helper&&b.helper.remove(),b.scroll_i&&(clearInterval(b.scroll_i),b.scroll_i=!1),b={element:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1},a(document).unbind("mousemove",a.vakata.dnd.drag),a(document).unbind("mouseup",a.vakata.dnd.stop)},_scroll:function(c){if(!b.scroll_e||!b.scroll_l&&!b.scroll_t)return b.scroll_i&&(clearInterval(b.scroll_i),b.scroll_i=!1),!1;if(!b.scroll_i)return b.scroll_i=setInterval(a.vakata.dnd._scroll,100),!1;if(c===!0)return!1;var d=b.scroll_e.scrollTop(),e=b.scroll_e.scrollLeft();b.scroll_e.scrollTop(d+b.scroll_t*a.vakata.dnd.settings.scroll_speed),b.scroll_e.scrollLeft(e+b.scroll_l*a.vakata.dnd.settings.scroll_speed),(d!==b.scroll_e.scrollTop()||e!==b.scroll_e.scrollLeft())&&a.vakata.dnd._trigger("scroll",b.scroll_e)},start:function(c,d,e){b.is_drag&&a.vakata.dnd.stop({});try{c.currentTarget.unselectable="on",c.currentTarget.onselectstart=function(){return!1},c.currentTarget.style&&(c.currentTarget.style.MozUserSelect="none")}catch(f){}return b.init_x=c.pageX,b.init_y=c.pageY,b.data=d,b.is_down=!0,b.element=c.currentTarget,e!==!1&&(b.helper=a("<div id='vakata-dnd'></div>").html(e).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),a(document).bind("mousemove",a.vakata.dnd.drag),a(document).bind("mouseup",a.vakata.dnd.stop),!1},drag:function(c){if(b.is_down){if(!b.is_drag){if(!(Math.abs(c.pageX-b.init_x)>a.vakata.dnd.settings.threshold||Math.abs(c.pageY-b.init_y)>a.vakata.dnd.settings.threshold))return;b.helper&&(b.helper.appendTo("body"),b.helper_w=b.helper.outerWidth()),b.is_drag=!0,a.vakata.dnd._trigger("start",c)}var d=!1,e=!1,f=!1,g=!1,h=!1,i=!1,j=!1,k=!1,l=!1,m=!1;b.scroll_t=0,b.scroll_l=0,b.scroll_e=!1,a(c.target).parentsUntil("body").addBack().vakata_reverse().filter(function(){return/^auto|scroll$/.test(a(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var d=a(this),e=d.offset();return this.scrollHeight>this.offsetHeight&&(e.top+d.height()-c.pageY<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_t=1),c.pageY-e.top<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(e.left+d.width()-c.pageX<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_l=1),c.pageX-e.left<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_l=-1)),b.scroll_t||b.scroll_l?(b.scroll_e=a(this),!1):void 0}),b.scroll_e||(d=a(document),e=a(window),f=d.height(),g=e.height(),h=d.width(),i=e.width(),j=d.scrollTop(),k=d.scrollLeft(),f>g&&c.pageY-j<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_t=-1),f>g&&g-(c.pageY-j)<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_t=1),h>i&&c.pageX-k<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_l=-1),h>i&&i-(c.pageX-k)<a.vakata.dnd.settings.scroll_proximity&&(b.scroll_l=1),(b.scroll_t||b.scroll_l)&&(b.scroll_e=d)),b.scroll_e&&a.vakata.dnd._scroll(!0),b.helper&&(l=parseInt(c.pageY+a.vakata.dnd.settings.helper_top,10),m=parseInt(c.pageX+a.vakata.dnd.settings.helper_left,10),f&&l+25>f&&(l=f-50),h&&m+b.helper_w>h&&(m=h-(b.helper_w+2)),b.helper.css({left:m+"px",top:l+"px"})),a.vakata.dnd._trigger("move",c)}},stop:function(c){b.is_drag&&a.vakata.dnd._trigger("stop",c),a.vakata.dnd._clean()}}}(jQuery),function(a){a.jstree.defaults.html={data:!1,ajax:!1},a.jstree.plugins.html=function(b,c){this.append_html_data=function(b,c){return c=a(c),b=this.get_node(b),c&&c.length&&c.is("ul, li")?(-1===b&&(b=this.element),b.length?(b.children("ul").length||b.append("<ul />"),b.children("ul").empty().append(c.is("ul")?c.children("li"):c),!0):!1):(b&&-1!==b&&b.is("li")&&b.removeClass("jstree-closed").addClass("jstree-leaf").children("ul").remove(),!0)},this._load_node=function(b,d){var e=a.extend(!0,{},this.settings.html);if(b=this.get_node(b),!b)return!1;switch(!0){case!e.data&&!e.ajax:return c._load_node.call(this,b,d);case a.isFunction(e.data):return e.data.call(this,b,a.proxy(function(a){return d.call(this,this._append_html_data(b,a))},this));case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&-1===b:return d.call(this,this._append_html_data(b,e.data));case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&-1!==b:return e.ajax.success=a.proxy(function(c,e,f){var g=this.settings.html.ajax;a.isFunction(g.success)&&(c=g.success.call(this,c,e,f)||c),d.call(this,this._append_html_data(b,c))},this),e.ajax.error=a.proxy(function(b,c,e){var f=this.settings.html.ajax;a.isFunction(f.error)&&f.error.call(this,b,c,e),d.call(this,!1)},this),e.ajax.dataType||(e.ajax.dataType="html"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}}},a.jstree.defaults.plugins.push("html")}(jQuery),function(a){a.jstree.defaults.json={data:!1,ajax:!1,progressive_render:!1,progressive_unload:!1},a.jstree.plugins.json=function(b,c){this.bind=function(){c.bind.call(this),this.element.bind("ready.jstree",a.proxy(function(){this.element.bind("after_close.jstree",a.proxy(function(b,c){var d=a(c.node);this.settings.json.progressive_unload&&0===d.find(".jstree-clicked:eq(0)").length&&(d.data("jstree").children=this.get_json(d)[0].children,d.children("ul").remove())},this))},this))},this.parse_json=function(b){var d=this.settings.json;return d.progressive_render&&a.isArray(b.children)&&!this._json_has_selected(b.children)&&(b.data||(b.data={}),b.data.jstree||(b.data.jstree={}),b.data.jstree.children=b.children,b.children=!0),c.parse_json.call(this,b)},this._json_has_selected=function(a){for(var b=!1,c=0,d=a.length;d>c&&(b=a[c].data&&a[c].data.jstree&&a[c].data.jstree.selected?!0:a[c].children?b||this._json_has_selected(a[c].children):!1,b!==!0);c++);return b},this._append_json_data=function(a,b){return a=this.get_node(a),-1===a&&(a=this.element),b=this.parse_json(b),a.length?b?(a.children("ul").length||a.append("<ul />"),a.children("ul").empty().append(b.is("li")?b:b.children("li")),!0):(a&&a.is("li")&&a.removeClass("jstree-closed").addClass("jstree-leaf").children("ul").remove(),!0):!1},this._load_node=function(b,d){var e=!1,f=a.extend(!0,{},this.settings.json);if(b=this.get_node(b),!b)return!1;switch(!0){case-1===b&&this.get_container().data("jstree")&&a.isArray(this.get_container().data("jstree").children):return e=this.element.data("jstree").children,this.get_container().data("jstree").children=null,d.call(this,this._append_json_data(b,e));case-1!==b&&b.length&&b.data("jstree")&&a.isArray(b.data("jstree").children):return e=b.data("jstree").children,b.data("jstree").children=null,d.call(this,this._append_json_data(b,e));case!f.data&&!f.ajax:return c._load_node.call(this,b,d);case a.isFunction(f.data):return f.data.call(this,b,a.proxy(function(a){return d.call(this,this._append_json_data(b,a))},this));case!!f.data&&!f.ajax||!!f.data&&!!f.ajax&&-1===b:return d.call(this,this._append_json_data(b,f.data));case!f.data&&!!f.ajax||!!f.data&&!!f.ajax&&-1!==b:return f.ajax.success=a.proxy(function(c,e,f){var g=this.settings.json.ajax;a.isFunction(g.success)&&(c=g.success.call(this,c,e,f)||c),d.call(this,this._append_json_data(b,c))},this),f.ajax.error=a.proxy(function(b,c,e){var f=this.settings.json.ajax;a.isFunction(f.error)&&f.error.call(this,b,c,e),d.call(this,!1)},this),f.ajax.dataType||(f.ajax.dataType="json"),a.isFunction(f.ajax.url)&&(f.ajax.url=f.ajax.url.call(this,b)),a.isFunction(f.ajax.data)&&(f.ajax.data=f.ajax.data.call(this,b)),a.ajax(f.ajax)}}},a.jstree.defaults.plugins.push("json")}(jQuery),function(a){a.jstree.defaults.rules={check_max_depth:!0,check_max_children:!0,check_valid_children:!0,types:{}},a.jstree.plugins.rules=function(b,c){this.bind=function(){c.bind.call(this),this.element.on("load_node.jstree",a.proxy(function(a,b){if(this.settings.rules.check_max_depth){var c=-1===b.node?this.element:b.node,d=this,e=function(){d.apply_max_depth(this)&&(c=c.not(this))};if(!this.apply_max_depth(c))for(;c.length;)c=c.children("ul").children("li"),c.each(e)}},this))},this.apply_max_depth=function(b){if(b=this.get_node(b),!b||!b.length)return!1;b=-1===b?this.element:b;var c=b.data("jstree"),d={},e=function(){d=a(this).data("jstree")||{},d.max_depth=0,a(this).data("jstree",d)},f=function(){d=a(this).data("jstree")||{},d.max_depth=d.max_depth&&-1!==d.max_depth?Math.min(d.max_depth,c):c,a(this).data("jstree",d)};if(c&&void 0!==c.max_depth&&-1!==c.max_depth){for(c=c.max_depth;b.length>0;){if(b=b.children("ul").children("li"),c=Math.max(c-1,0),0===c){b.find("li").addBack().each(e);break}b.each(f)}return!0}return!1},this.get_rules=function(a){if(a=this.get_node(a),-1===a)return a=this.element,a=a.data("jstree"),{type:!1,max_depth:a&&a.max_depth?a.max_depth:-1,max_children:a&&a.max_children?a.max_children:-1,valid_children:a&&a.valid_children?a.valid_children:-1};if(!a||!a.length)return!1;var b=this.settings.rules,c=this.get_type(a),d={type:c,max_depth:-1,max_children:-1,valid_children:-1};return a=a.data("jstree"),c&&b[c]&&(b[c].max_depth&&(d.max_depth=b[c].max_depth),b[c].max_children&&(d.max_children=b[c].max_children),b[c].valid_children&&(d.valid_children=b[c].valid_children)),a&&void 0!==a.max_children&&(d.max_children=a.max_children),a&&void 0!==a.valid_children&&(d.valid_children=a.valid_children),a&&void 0!==a.max_depth&&(-1===d.max_depth||-1!==a.max_depth&&a.max_depth<d.max_depth)&&(d.max_depth=a.max_depth),d},this.get_type=function(a){return a=this.get_node(a),-1===a&&(a=this.element),a&&a.length?(a=a.data("jstree"),a&&a.type?a.type:!1):!1},this.set_type=function(a,b){if(a=this.get_node(a),-1===a&&(a=this.element),!a||!a.length)return!1;var c=a.data("jstree");return c||(c={}),c.type=b,a.data("jstree",c),!0},this.check=function(b,d,e,f){if(c.check.call(this,b,d,e,f)===!1)return!1;var g=!1,h=this.settings.rules,i=this,j=0;switch(b){case"create_node":case"move_node":case"copy_node":if(!(h.check_max_children||h.check_valid_children||h.check_max_depth))return!0;if(g=this.get_rules(e),h.check_max_children&&void 0!==g.max_children&&-1!==g.max_children&&e.children("ul").children("li").not("move_node"===b?d:null).length+d.length>g.max_children)return!1;if(h.check_valid_children&&void 0!==g.valid_children&&-1!==g.valid_children){if(!a.isArray(g.valid_children))return!1;if(d.each(function(){return-1===a.inArray(i.get_type(this),g.valid_children)?(i=!1,!1):void 0}),i===!1)return!1}if(h.check_max_depth&&-1!==g.max_depth){j=0;do j++,d=d.children("ul").children("li");while(d.length&&"create_node"!==b);if(0>g.max_depth-j)return!1}}return!0}},a.jstree.defaults.plugins.push("rules")}(jQuery),function(a){a.jstree.defaults.search={ajax:!1,case_sensitive:!1,show_only_matches:!0},a.jstree.plugins.search=function(b,c){this.bind=function(){c.bind.call(this),this._data.search.str="",this._data.search.res=a(),this.settings.search.show_only_matches&&this.element.on("search.jstree",function(b,c){c.nodes.length&&(a(this).children("ul").find("li").hide().removeClass("jstree-last"),c.nodes.parentsUntil(".jstree").addBack().show().filter("ul").each(function(){a(this).children("li:visible").eq(-1).addClass("jstree-last")}))}).on("clear_search.jstree",function(b,c){c.nodes.length&&a(this).children("ul").find("li").css("display","").end().end().jstree("correct_node",-1,!0)})},this.search=function(b,c){if(b===!1||""===a.trim(b))return this.clear_search();var d=this.settings.search,e=this;return!c&&d.ajax!==!1&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0?(d.ajax.success=a.proxy(function(c,d,e){var f=this.settings.search.ajax;a.isFunction(f.success)&&(c=f.success.call(this,c,d,e)||c),this._search_open(c,b)},this),d.ajax.error=a.proxy(function(b,c,d){var e=this.settings.search.ajax;a.isFunction(e.error)&&e.error.call(this,b,c,d)},this),d.ajax.dataType||(d.ajax.dataType="json"),a.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,b)),a.isFunction(d.ajax.data)?d.ajax.data=d.ajax.data.call(this,b):(d.ajax.data||(d.ajax.data={}),d.ajax.data.str=b),a.ajax(d.ajax),void 0):(this._data.search.res.length&&this.clear_search(),this._data.search.str=b,this._data.search.res=this._search(b),this._data.search.res.addClass("jstree-search").parent().parentsUntil(".jstree",".jstree-closed").each(function(){e.open_node(this,!1,0)}),this.trigger("search",{nodes:this._data.search.res,str:b}),void 0)},this.clear_search=function(){this._data.search.res.removeClass("jstree-search"),this.trigger("clear_search",{nodes:this._data.search.res,str:this._data.search.str}),this._data.search.str="",this._data.search.res=a()},this._search=function(b){return b=this.settings.search.case_sensitive?b:b.toLowerCase(),this.settings.json&&this.settings.json.progressive_render&&this.get_container_ul().find("li.jstree-closed:not(:has(ul))").each(a.proxy(function(c,d){this._search_data(b,a(d).data("jstree"))&&this.open_node(d,!1,0)},this)),this.element.find(".jstree-anchor:"+(this.settings.search.case_sensitive?"contains":"vakata_icontains")+"("+b+")")},this._search_data=function(b,c){if(!c||!c.children||!a.isArray(c.children))return!1;var d=!1;return a.each(c.children,a.proxy(function(a,e){var f,g="string"==typeof e?e:e.title;g=this.settings.search.case_sensitive?g:g.toLowerCase(),f=-1!==g.indexOf(b)||this._search_data(b,e),f&&(c.data||(c.data={}),c.data.jstree||(c.data.jstree={}),c.data.jstree.opened=!0),d=d||f},this)),d},this._search_open=function(b,c){var d=!0,e=this;a.each(b.concat([]),function(f,g){g=document.getElementById(g),g&&(e.is_loaded(g)?(e.is_closed(g)&&e.open_node(g,!1,0),a.vakata.array_remove(b,f)):(e.is_loading(g)||e.open_node(g,a.proxy(function(){this._search_open(b,c)},e),0),d=!1))}),d&&this.search(c,!0)}},a.expr[":"].vakata_icontains=a.expr.createPseudo(function(a){return function(b){return(b.textContent||b.innerText||"").toLowerCase().indexOf(a.toLowerCase())>=0}}),a.jstree.defaults.plugins.push("search")}(jQuery),function(a){a.jstree.defaults.sort=function(a,b){return this.get_text(a,!0)>this.get_text(b,!0)?1:-1},a.jstree.plugins.sort=function(b,c){this.bind=function(){c.bind.call(this),this.element.on("load_node.jstree",a.proxy(function(a,b){var c=this.get_node(b.node);c=-1===c?this.get_container_ul():c.children("ul"),this.sort(c,!0)},this)).on("rename_node.jstree create_node.jstree",a.proxy(function(a,b){this.sort(b.node.parent(),!1)},this)).on("move_node.jstree copy_node.jstree",a.proxy(function(a,b){var c=-1===b.parent?this.get_container_ul():b.parent.children("ul");this.sort(c,!1)},this))},this.sort=function(b,c){var d=this.settings.sort,e=this;b.append(a.makeArray(b.children("li")).sort(a.proxy(d,e))),b.children("li").each(function(){e.correct_node(this,!1)}),c&&(b.children("li").children("ul").each(function(){e.sort(a(this))}),e.correct_node(b.children("li"),!0))}},a.jstree.defaults.plugins.push("sort")}(jQuery),function(a){var b=!1;a.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree",ttl:!1},a.jstree.plugins.state=function(c,d){this.bind=function(){d.bind.call(this),this.element.on("ready.jstree",a.proxy(function(){this.element.one("restore_state.jstree set_state.jstree",a.proxy(function(){this.element.on(this.settings.state.events,a.proxy(function(){b&&clearTimeout(b),b=setTimeout(a.proxy(function(){this.save_state()},this),100)},this))},this)),this.restore_state()},this))},this.save_state=function(){a.vakata.storage.set(this.settings.state.key,this.get_state(),this.settings.state.ttl)},this.restore_state=function(){var b=a.vakata.storage.get(this.settings.state.key);b&&this.set_state(b),this.trigger("restore_state",{state:b})},this.clear_state=function(){return a.vakata.storage.del(this.settings.state.key)}}}(jQuery),function(a,b,c){var d=function(a){return a},e=function(a){return decodeURIComponent(a.replace(/\+/g," "))},f=a.vakata.cookie=function(g,h,i){if(h!==c){if(i=a.extend({},f.defaults,i),null===h&&(i.expires=-1),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setDate(k.getDate()+j)}return h=f.json?a.vakata.json.encode(h):h+"",b.cookie=[encodeURIComponent(g),"=",f.raw?h:encodeURIComponent(h),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=f.raw?d:e,m=b.cookie.split("; "),n=0,o=m.length;o>n;n++){var p=m[n].split("=");if(l(p.shift())===g){var q=l(p.join("="));return f.json?a.vakata.json.decode(q):q}}return null};f.defaults={},a.vakata.removeCookie=function(b,c){return null!==a.cookie(b)?(a.cookie(b,null,c),!0):!1}}(jQuery,document),function(a){function b(){var b=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),b=!0,window.localStorage.removeItem("_tmptest")}catch(d){}if(b)try{window.localStorage&&(h=window.localStorage,m="localStorage")}catch(e){}else if("globalStorage"in window)try{window.globalStorage&&(h=window.globalStorage[window.location.hostname],m="globalStorage")}catch(g){}else{if(i=document.createElement("link"),i.addBehavior){i.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(i);try{i.load("jStorage");var j="{}";j=i.getAttribute("jStorage"),h.jStorage=j,m="userDataBehavior"}catch(k){}}if(!m&&(a.vakata.cookie("__vjstorage")||a.vakata.cookie("__vjstorage","{}",{expires:365})&&"{}"===a.vakata.cookie("__vjstorage"))&&(i=null,h.jStorage=a.vakata.cookie("__vjstorage"),m="cookie"),!m)return i=null,void 0}c(),f()}function c(){if(h.jStorage)try{g=l(h.jStorage+"")}catch(a){h.jStorage="{}"}else h.jStorage="{}";j=h.jStorage?(h.jStorage+"").length:0}function d(){try{h.jStorage=k(g),"userDataBehavior"===m&&(i.setAttribute("jStorage",h.jStorage),i.save("jStorage")),"cookie"===m&&a.vakata.cookie("__vjstorage",h.jStorage,{expires:365}),j=h.jStorage?(h.jStorage+"").length:0}catch(b){}}function e(a){if(!a||"string"!=typeof a&&"number"!=typeof a)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"===a)throw new TypeError("Reserved key name");return!0}function f(){var a,b,c=+new Date,e=1/0,h=!1;if(n!==!1&&clearTimeout(n),g.__jstorage_meta&&"object"==typeof g.__jstorage_meta.TTL){b=g.__jstorage_meta.TTL;for(a in b)b.hasOwnProperty(a)&&(c>=b[a]?(delete b[a],delete g[a],h=!0):e>b[a]&&(e=b[a]));
1/0!==e&&(n=setTimeout(f,e-c)),h&&d()}}var g={},h={jStorage:"{}"},i=null,j=0,k=a.vakata.json.encode,l=a.vakata.json.decode,m=!1,n=!1;a.vakata.storage={version:"0.3.0",set:function(b,c,f){return e(b),"object"==typeof c&&(c=l(k(c))),g[b]=c,d(),f&&parseInt(f,10)&&a.vakata.storage.setTTL(b,parseInt(f,10)),c},get:function(a,b){return e(a),a in g?g[a]:void 0===b?null:b},del:function(a){return e(a),a in g?(delete g[a],g.__jstorage_meta&&"object"==typeof g.__jstorage_meta.TTL&&a in g.__jstorage_meta.TTL&&delete g.__jstorage_meta.TTL[a],d(),!0):!1},setTTL:function(a,b){var c=+new Date;return e(a),b=Number(b)||0,a in g?(g.__jstorage_meta||(g.__jstorage_meta={}),g.__jstorage_meta.TTL||(g.__jstorage_meta.TTL={}),b>0?g.__jstorage_meta.TTL[a]=c+b:delete g.__jstorage_meta.TTL[a],d(),f(),!0):!1},getTTL:function(a){var b,c=+new Date;return e(a),a in g&&g.__jstorage_meta.TTL&&g.__jstorage_meta.TTL[a]?(b=g.__jstorage_meta.TTL[a]-c,b||0):0},flush:function(){return g={},d(),!0},storageObj:function(){return a.extend(!0,{},g)},index:function(){var b=[];return a.each(g,function(a){"__jstorage_meta"!==a&&b.push(a)}),b},storageSize:function(){return j},currentBackend:function(){return m},storageAvailable:function(){return!!m}},b()}(jQuery),function(a){a.jstree.plugins.unique=function(b,c){this.check=function(b,d,e,f){if(c.check.call(this,b,d,e,f)===!1)return!1;e=-1===e?this.element:e;var g="rename_node"===b?a("<div />").html(f).text():this.get_text(d,!0),h=[],i=this;switch(e.children("ul").children("li").each(function(){h.push(i.get_text(this,!0))}),b){case"delete_node":return!0;case"rename_node":case"copy_node":return-1===a.inArray(g,h);case"move_node":return-1!==e.children("ul").children("li").index(d)||-1===a.inArray(g,h)}return!0}},a.jstree.defaults.plugins.push("unique")}(jQuery),function(a){a.jstree.plugins.wholerow=function(b,c){this.bind=function(){c.bind.call(this),this.element.on("ready.jstree set_state.jstree",a.proxy(function(){this.hide_dots()},this)).on("ready.jstree",a.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",a.proxy(function(){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree ",a.proxy(function(a,b){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked"),b.selected.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",a.proxy(function(b,c){this.element.find(".jstree-wholerow-hovered").removeClass("jstree-wholerow-hovered"),"hover_node"===b.type&&c.node.each(function(){a(this).children(".jstree-wholerow").addClass("jstree-wholerow-hovered")})},this)).on("contextmenu.jstree",".jstree-wholerow",a.proxy(function(b){void 0!==this._data.contextmenu&&(b.preventDefault(),a(b.currentTarget).closest("li").children("a:eq(0)").trigger("contextmenu",b))},this)).on("click.jstree",".jstree-wholerow",function(b){b.stopImmediatePropagation(),a(b.currentTarget).closest("li").children("a:eq(0)").trigger("click",b)}).on("click.jstree",".jstree-leaf > .jstree-ocl",a.proxy(function(b){b.stopImmediatePropagation(),a(b.currentTarget).closest("li").children("a:eq(0)").trigger("click",b)},this)).on("mouseover.jstree","li",a.proxy(function(b){return b.stopImmediatePropagation(),a(b.currentTarget).closest("li").children(".jstree-hovered, .jstree-clicked").length?!1:(this.hover_node(b.currentTarget),!1)},this)).on("mouseleave.jstree","li",a.proxy(function(a){this.dehover_node(a.currentTarget)},this))},this.teardown=function(){this.element.find(".jstree-wholerow").remove(),c.teardown.call(this)},this.clean_node=function(b){b=c.clean_node.call(this,b);var d=this;return b.each(function(){var b=a(this);b.children(".jstree-wholerow").length||b.prepend("<div class='jstree-wholerow' style='position:absolute; height:"+d._data.core.li_height+"px;' unselectable='on'>&#160;</div>")})}},a(function(){var b=".jstree .jstree-wholerow-ul { position:relative; display:inline-block; min-width:100%; }.jstree-wholerow-ul li > a, .jstree-wholerow-ul li > i { position:relative; }.jstree-wholerow-ul .jstree-wholerow { width:100%; cursor:pointer; position:absolute; left:0; user-select:none;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; }";a.jstree.no_css||a("head").append('<style type="text/css">'+b+"</style>")})}(jQuery),function(a){var b={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:for-each select="@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>			<a>				<xsl:for-each select="./content/@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>				<xsl:copy-of select="./content/child::node()" />			</a>			<xsl:if test="$children"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>		<xsl:for-each select="@*">			<xsl:if test="name() != \'parent_id\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>		<a>			<xsl:for-each select="./content/@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>			<xsl:copy-of select="./content/child::node()" />		</a>		<xsl:if test="$children">		<ul>			<xsl:for-each select="//item[@parent_id=$node/attribute::id]">				<xsl:call-template name="nodes">					<xsl:with-param name="node" select="." />				</xsl:call-template>			</xsl:for-each>		</ul>		</xsl:if>	</li></xsl:template></xsl:stylesheet>'},c=function(a){return(""+a).replace(/&/g,"&amp;").replace(/<'+'/g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};a.jstree.defaults.xml={xsl:"flat",data:!1,ajax:!1},a.jstree.plugins.xml=function(d,e){this._append_xml_data=function(c,d){return d=a.vakata.xslt(d,b[this.settings.xml.xsl]),d===!1?!1:(d=a(d),c=this.get_node(c),d&&d.length&&d.is("ul, li")?(-1===c&&(c=this.element),c.length?(c.children("ul").length||c.append("<ul />"),c.children("ul").empty().append(d.is("ul")?d.children("li"):d),!0):!1):(c&&-1!==c&&c.is("li")&&c.removeClass("jstree-closed").addClass("jstree-leaf").children("ul").remove(),!0))},this._load_node=function(b,c){var d=a.extend(!0,{},this.settings.xml);if(b=this.get_node(b),!b)return!1;switch(!0){case!d.data&&!d.ajax:return e._load_node.call(this,b,c);case a.isFunction(d.data):return d.data.call(this,b,a.proxy(function(a){return c.call(this,this._append_xml_data(b,a))},this));case!!d.data&&!d.ajax||!!d.data&&!!d.ajax&&-1===b:return c.call(this,this._append_xml_data(b,d.data));case!d.data&&!!d.ajax||!!d.data&&!!d.ajax&&-1!==b:return d.ajax.success=a.proxy(function(d,e,f){var g=this.settings.xml.ajax;a.isFunction(g.success)&&(d=g.success.call(this,d,e,f)||d),c.call(this,this._append_xml_data(b,d))},this),d.ajax.error=a.proxy(function(b,d,e){var f=this.settings.xml.ajax;a.isFunction(f.error)&&f.error.call(this,b,d,e),c.call(this,!1)},this),d.ajax.dataType||(d.ajax.dataType="xml"),a.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,b)),a.isFunction(d.ajax.data)&&(d.ajax.data=d.ajax.data.call(this,b)),a.ajax(d.ajax)}},this.get_xml=function(b,d,e){var f="";return b||(b="flat"),void 0===e?(d=this.get_json(d),a.each(d,a.proxy(function(a,c){f+=this.get_xml(b,c,!0)},this)),'<?xml version="1.0" encoding="utf-8" ?><root>'+f+"<"+"/root>"):(f+="<item","flat"===b&&e!==!0&&(f+=' parent_id="'+c(e)+'"'),d.data&&!a.isEmptyObject(d.data)&&a.each(d.data,function(b,d){a.isEmptyObject(d)||(f+=" data-"+b+'="'+c(a.vakata.json.encode(d))+'"')}),a.each(d.li_attr,function(a,b){f+=" "+a+'="'+c(b)+'"'}),f+=">",f+="<content",a.each(d.a_attr,function(a,b){f+=" "+a+'="'+c(b)+'"'}),f+="><![CDATA["+d.title+"]]><"+"/content>","flat"===b&&(f+="</item>"),d.children&&a.each(d.children,a.proxy(function(a,c){f+=this.get_xml(b,c,d.li_attr&&d.li_attr.id?d.li_attr.id:!0)},this)),"nest"===b&&(f+="</item>"),f)}},a.jstree.defaults.plugins.push("xml"),a.vakata.xslt=function(b,c){var d,e,f,g=!1,h=a.parseXML(b),i=a.parseXML(c);if("undefined"!=typeof XSLTProcessor)return d=new XSLTProcessor,d.importStylesheet(i),g=d.transformToFragment(h,document),a("<div />").append(g).html();if(void 0!==h.transformNode)return h.transformNode(i);if(window.ActiveXObject)try{g=new ActiveXObject("Msxml2.XSLTemplate"),e=new ActiveXObject("Msxml2.DOMDocument"),e.loadXML(b),f=new ActiveXObject("Msxml2.FreeThreadedDOMDocument"),f.loadXML(c),g.stylesheet=f,d=g.createProcessor(),d.input=e,d.transform(),g=d.output}catch(j){}return g}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?(arguments.length&&this._createWidget(a,b),void 0):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}(),void 0):(i[b]=d,void 0)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; "+"attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}),function(a){"use strict";var b=function(a,c){var d=/[^\w\-\.:]/.test(a)?new Function(b.arg+",tmpl","var _e=tmpl.encode"+b.helper+",_s='"+a.replace(b.regexp,b.func)+"';return _s;"):b.cache[a]=b.cache[a]||b(b.load(a));return c?d(c,b):function(a){return d(a,b)}};b.cache={},b.load=function(a){return document.getElementById(a).innerHTML},b.regexp=/([\s'\\])(?![^%]*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,b.func=function(a,b,c,d,e,f){return b?{"\n":"\\n","\r":"\\r","	":"\\t"," ":" "}[a]||"\\"+a:c?"="===c?"'+_e("+d+")+'":"'+("+d+"||'')+'":e?"';":f?"_s+='":void 0},b.encReg=/[<>&"'\x00]/g,b.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},b.encode=function(a){return String(a||"").replace(b.encReg,function(a){return b.encMap[a]||""})},b.arg="o",b.helper=",print=function(s,e){_s+=e&&(s||'')||_e(s);},include=function(s,d){_s+=tmpl(s,d);}","function"==typeof define&&define.amd?define(function(){return b}):a.tmpl=b}(this),function(a){"use strict";var b=function(a,c,d){var e,f,g=document.createElement("img");if(g.onerror=c,g.onload=function(){!f||d&&d.noRevoke||b.revokeObjectURL(f),c&&c(b.scale(g,d))},b.isInstanceOf("Blob",a)||b.isInstanceOf("File",a))e=f=b.createObjectURL(a),g._type=a.type;else{if("string"!=typeof a)return!1;e=a,d&&d.crossOrigin&&(g.crossOrigin=d.crossOrigin)}return e?(g.src=e,g):b.readFile(a,function(a){var b=a.target;b&&b.result?g.src=b.result:c&&c(a)})},c=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;b.isInstanceOf=function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},b.detectSubsampling=function(a){var b,c;return a.width*a.height>1048576?(b=document.createElement("canvas"),b.width=b.height=1,c=b.getContext("2d"),c.drawImage(a,-a.width+1,0),0===c.getImageData(0,0,1,1).data[3]):!1},b.detectVerticalSquash=function(a,b){var c,d,e,f,g,h=document.createElement("canvas"),i=h.getContext("2d");for(h.width=1,h.height=b,i.drawImage(a,0,0),c=i.getImageData(0,0,1,b).data,d=0,e=b,f=b;f>d;)g=c[4*(f-1)+3],0===g?e=f:d=f,f=e+d>>1;return f/b||1},b.renderImageToCanvas=function(a,c,d,e,f,g,h,i,j,k){var l,m,n,o=a.getContext("2d"),p=document.createElement("canvas"),q=p.width=p.height=1024,r=p.getContext("2d");for(o.save(),b.detectSubsampling(c)&&(f/=2,g/=2),l=b.detectVerticalSquash(c,g),j=Math.ceil(q*j/f),k=Math.ceil(q*k/g/l),i=0,n=0;g>n;){for(h=0,m=0;f>m;)r.clearRect(0,0,q,q),r.drawImage(c,d,e,f,g,-m,-n,f,g),o.drawImage(p,0,0,q,q,h,i,j,k),m+=q,h+=j;n+=q,i+=k}o.restore()},b.scale=function(a,c){c=c||{};var d,e,f,g=document.createElement("canvas"),h=a.getContext||(c.canvas||c.crop)&&g.getContext,i=a.width,j=a.height,k=c.maxWidth,l=c.maxHeight,m=i,n=j,o=0,p=0,q=0,r=0;return h&&k&&l&&c.crop?(d=k,e=l,k/l>i/j?(n=l*i/k,p=(j-n)/2):(m=k*j/l,o=(i-m)/2)):(d=i,e=j,f=Math.max((c.minWidth||d)/d,(c.minHeight||e)/e),f>1&&(d=Math.ceil(d*f),e=Math.ceil(e*f)),f=Math.min((k||d)/d,(l||e)/e),1>f&&(d=Math.ceil(d*f),e=Math.ceil(e*f))),h?(g.width=d,g.height=e,"image/jpeg"===a._type?b.renderImageToCanvas(g,a,o,p,m,n,q,r,d,e):g.getContext("2d").drawImage(a,o,p,m,n,q,r,d,e),g):(a.width=d,a.height=e,a)},b.createObjectURL=function(a){return c?c.createObjectURL(a):!1},b.revokeObjectURL=function(a){return c?c.revokeObjectURL(a):!1},b.readFile=function(a,b){if(window.FileReader&&FileReader.prototype.readAsDataURL){var c=new FileReader;return c.onload=c.onerror=b,c.readAsDataURL(a),c}return!1},"function"==typeof define&&define.amd?define(function(){return b}):a.loadImage=b}(this),function(a){"use strict";var b=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,c=a.Blob&&function(){try{return Boolean(new Blob)}catch(a){return!1}}(),d=c&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(a){return!1}}(),e=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,f=(c||e)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(a){var b,f,g,h,i,j;for(b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]),f=new ArrayBuffer(b.length),g=new Uint8Array(f),h=0;h<b.length;h+=1)g[h]=b.charCodeAt(h);return i=a.split(",")[0].split(":")[1].split(";")[0],c?new Blob([d?g:f],{type:i}):(j=new e,j.append(f),j.getBlob(i))};a.HTMLCanvasElement&&!b.toBlob&&(b.mozGetAsFile?b.toBlob=function(a,c,d){d&&b.toDataURL&&f?a(f(this.toDataURL(c,d))):a(this.mozGetAsFile("blob",c))}:b.toDataURL&&f&&(b.toBlob=function(a,b,c){a(f(this.toDataURL(b,c)))})),"function"==typeof define&&define.amd?define(function(){return f}):a.dataURLtoBlob=f}(this),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery)}(function(a){"use strict";var b=0;a.ajaxTransport("iframe",function(c){if(c.async){var d,e,f;return{send:function(g,h){d=a('<form style="display:none;"></form>'),d.attr("accept-charset",c.formAcceptCharset),f=/\?/.test(c.url)?"&":"?","DELETE"===c.type?(c.url=c.url+f+"_method=DELETE",c.type="POST"):"PUT"===c.type?(c.url=c.url+f+"_method=PUT",c.type="POST"):"PATCH"===c.type&&(c.url=c.url+f+"_method=PATCH",c.type="POST"),b+=1,e=a('<iframe src="javascript:false;" name="iframe-transport-'+b+'"></iframe>').bind("load",function(){var b,f=a.isArray(c.paramName)?c.paramName:[c.paramName];e.unbind("load").bind("load",function(){var b;try{if(b=e.contents(),!b.length||!b[0].firstChild)throw new Error}catch(c){b=void 0}h(200,"success",{iframe:b}),a('<iframe src="javascript:false;"></iframe>').appendTo(d),window.setTimeout(function(){d.remove()},0)}),d.prop("target",e.prop("name")).prop("action",c.url).prop("method",c.type),c.formData&&a.each(c.formData,function(b,c){a('<input type="hidden"/>').prop("name",c.name).val(c.value).appendTo(d)}),c.fileInput&&c.fileInput.length&&"POST"===c.type&&(b=c.fileInput.clone(),c.fileInput.after(function(a){return b[a]}),c.paramName&&c.fileInput.each(function(b){a(this).prop("name",f[b]||c.paramName)}),d.append(c.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),d.submit(),b&&b.length&&c.fileInput.each(function(c,d){var e=a(b[c]);a(d).prop("name",e.prop("name")),e.replaceWith(d)})}),d.append(e).appendTo(document.body)},abort:function(){e&&e.unbind("load").prop("src","javascript".concat(":false;")),d&&d.remove()}}}}),a.ajaxSetup({converters:{"iframe text":function(b){return b&&a(b[0].body).text()},"iframe json":function(b){return b&&a.parseJSON(a(b[0].body).text())},"iframe html":function(b){return b&&a(b[0].body).html()},"iframe xml":function(b){var c=b&&b[0];return c&&a.isXMLDoc(c)?c:a.parseXML(c.XMLDocument&&c.XMLDocument.xml||a(c.body).html())},"iframe script":function(b){return b&&a.globalEval(a(b[0].body).text())}}})}),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],a):a(window.jQuery)}(function(a){"use strict";a.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),a.support.xhrFormDataFileUpload=!!window.FormData,a.widget("blueimp.fileupload",{options:{dropZone:a(document),pasteZone:a(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(b,c){return b=this.messages[b]||b.toString(),c&&a.each(c,function(a,c){b=b.replace("{"+a+"}",c)}),b},formData:function(a){return a.serializeArray()},add:function(b,c){(c.autoUpload||c.autoUpload!==!1&&a(this).fileupload("option","autoUpload"))&&c.process().done(function(){c.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(a,b,c){var d=a-this.timestamp;return(!this.bitrate||!c||d>c)&&(this.bitrate=8*(b-this.loaded)*(1e3/d),this.loaded=b,this.timestamp=a),this.bitrate}},_isXHRUpload:function(b){return!b.forceIframeTransport&&(!b.multipart&&a.support.xhrFileUpload||a.support.xhrFormDataFileUpload)},_getFormData:function(b){var c;return"function"==typeof b.formData?b.formData(b.form):a.isArray(b.formData)?b.formData:"object"===a.type(b.formData)?(c=[],a.each(b.formData,function(a,b){c.push({name:a,value:b})}),c):[]},_getTotal:function(b){var c=0;return a.each(b,function(a,b){c+=b.size||1}),c},_initProgressObject:function(b){var c={loaded:0,total:0,bitrate:0};b._progress?a.extend(b._progress,c):b._progress=c},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&delete a._response[b];else a._response={}},_onProgress:function(a,b){if(a.lengthComputable){var c,d=Date.now?Date.now():(new Date).getTime();if(b._time&&b.progressInterval&&d-b._time<b.progressInterval&&a.loaded!==a.total)return;b._time=d,c=Math.floor(a.loaded/a.total*(b.chunkSize||b._progress.total))+(b.uploadedBytes||0),this._progress.loaded+=c-b._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(d,this._progress.loaded,b.bitrateInterval),b._progress.loaded=b.loaded=c,b._progress.bitrate=b.bitrate=b._bitrateTimer.getBitrate(d,c,b.bitrateInterval),this._trigger("progress",a,b),this._trigger("progressall",a,this._progress)}},_initProgressListener:function(b){var c=this,d=b.xhr?b.xhr():a.ajaxSettings.xhr();d.upload&&(a(d.upload).bind("progress",function(a){var d=a.originalEvent;a.lengthComputable=d.lengthComputable,a.loaded=d.loaded,a.total=d.total,c._onProgress(a,b)}),b.xhr=function(){return d})},_isInstanceOf:function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(b){var c,d=this,e=b.files[0],f=b.multipart||!a.support.xhrFileUpload,g=b.paramName[0];b.headers=b.headers||{},b.contentRange&&(b.headers["Content-Range"]=b.contentRange),f?a.support.xhrFormDataFileUpload&&(b.postMessage?(c=this._getFormData(b),b.blob?c.push({name:g,value:b.blob}):a.each(b.files,function(a,d){c.push({name:b.paramName[a]||g,value:d})})):(d._isInstanceOf("FormData",b.formData)?c=b.formData:(c=new FormData,a.each(this._getFormData(b),function(a,b){c.append(b.name,b.value)})),b.blob?(b.headers["Content-Disposition"]='attachment; filename="'+encodeURI(e.name)+'"',c.append(g,b.blob,e.name)):a.each(b.files,function(a,e){(d._isInstanceOf("File",e)||d._isInstanceOf("Blob",e))&&c.append(b.paramName[a]||g,e,e.name)})),b.data=c):(b.headers["Content-Disposition"]='attachment; filename="'+encodeURI(e.name)+'"',b.contentType=e.type,b.data=b.blob||e),b.blob=null},_initIframeSettings:function(b){var c=a("<a></a>").prop("href",b.url).prop("host");b.dataType="iframe "+(b.dataType||""),b.formData=this._getFormData(b),b.redirect&&c&&c!==location.host&&b.formData.push({name:b.redirectParamName||"redirect",value:b.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(b){var c=a(b.fileInput),d=b.paramName;return d?a.isArray(d)||(d=[d]):(d=[],c.each(function(){for(var b=a(this),c=b.prop("name")||"files[]",e=(b.prop("files")||[1]).length;e;)d.push(c),e-=1}),d.length||(d=[c.prop("name")||"files[]"])),d},_initFormSettings:function(b){b.form&&b.form.length||(b.form=a(b.fileInput.prop("form")),b.form.length||(b.form=a(this.options.fileInput.prop("form")))),b.paramName=this._getParamName(b),b.url||(b.url=b.form.prop("action")||location.href),b.type=(b.type||b.form.prop("method")||"").toUpperCase(),"POST"!==b.type&&"PUT"!==b.type&&"PATCH"!==b.type&&(b.type="POST"),b.formAcceptCharset||(b.formAcceptCharset=b.form.attr("accept-charset"))},_getAJAXSettings:function(b){var c=a.extend({},this.options,b);return this._initFormSettings(c),this._initDataSettings(c),c},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?"rejected":"pending"},_enhancePromise:function(a){return a.success=a.done,a.error=a.fail,a.complete=a.always,a},_getXHRPromise:function(b,c,d){var e=a.Deferred(),f=e.promise();return c=c||this.options.context||f,b===!0?e.resolveWith(c,d):b===!1&&e.rejectWith(c,d),f.abort=e.promise,this._enhancePromise(f)},_addConvenienceMethods:function(b,c){var d=this,e=function(b){return a.Deferred().resolveWith(d,[b]).promise()};c.process=function(a,b){return(a||b)&&(c._processQueue=this._processQueue=(this._processQueue||e(this)).pipe(a,b)),this._processQueue||e(this)},c.submit=function(){return"pending"!==this.state()&&(c.jqXHR=this.jqXHR=d._trigger("submit",b,this)!==!1&&d._onSend(b,this)),this.jqXHR||d._getXHRPromise()},c.abort=function(){return this.jqXHR?this.jqXHR.abort():d._getXHRPromise()},c.state=function(){return this.jqXHR?d._getDeferredState(this.jqXHR):this._processQueue?d._getDeferredState(this._processQueue):void 0},c.progress=function(){return this._progress},c.response=function(){return this._response}},_getUploadedBytes:function(a){var b=a.getResponseHeader("Range"),c=b&&b.split("-"),d=c&&c.length>1&&parseInt(c[1],10);return d&&d+1},_chunkedUpload:function(b,c){var d,e,f=this,g=b.files[0],h=g.size,i=b.uploadedBytes=b.uploadedBytes||0,j=b.maxChunkSize||h,k=g.slice||g.webkitSlice||g.mozSlice,l=a.Deferred(),m=l.promise();return this._isXHRUpload(b)&&k&&(i||h>j)&&!b.data?c?!0:i>=h?(g.error=b.i18n("uploadedBytes"),this._getXHRPromise(!1,b.context,[null,"error",g.error])):(e=function(){var c=a.extend({},b),m=c._progress.loaded;c.blob=k.call(g,i,i+j,g.type),c.chunkSize=c.blob.size,c.contentRange="bytes "+i+"-"+(i+c.chunkSize-1)+"/"+h,f._initXHRData(c),f._initProgressListener(c),d=(f._trigger("chunksend",null,c)!==!1&&a.ajax(c)||f._getXHRPromise(!1,c.context)).done(function(d,g,j){i=f._getUploadedBytes(j)||i+c.chunkSize,m+c.chunkSize-c._progress.loaded&&f._onProgress(a.Event("progress",{lengthComputable:!0,loaded:i-c.uploadedBytes,total:i-c.uploadedBytes}),c),b.uploadedBytes=c.uploadedBytes=i,c.result=d,c.textStatus=g,c.jqXHR=j,f._trigger("chunkdone",null,c),f._trigger("chunkalways",null,c),h>i?e():l.resolveWith(c.context,[d,g,j])}).fail(function(a,b,d){c.jqXHR=a,c.textStatus=b,c.errorThrown=d,f._trigger("chunkfail",null,c),f._trigger("chunkalways",null,c),l.rejectWith(c.context,[a,b,d])})},this._enhancePromise(m),m.abort=function(){return d.abort()},e(),m):!1},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(b),this._initProgressObject(b),b._progress.loaded=b.loaded=b.uploadedBytes||0,b._progress.total=b.total=this._getTotal(b.files)||1,b._progress.bitrate=b.bitrate=0,this._active+=1,this._progress.loaded+=b.loaded,this._progress.total+=b.total},_onDone:function(b,c,d,e){var f=e._progress.total,g=e._response;e._progress.loaded<f&&this._onProgress(a.Event("progress",{lengthComputable:!0,loaded:f,total:f}),e),g.result=e.result=b,g.textStatus=e.textStatus=c,g.jqXHR=e.jqXHR=d,this._trigger("done",null,e)},_onFail:function(a,b,c,d){var e=d._response;d.recalculateProgress&&(this._progress.loaded-=d._progress.loaded,this._progress.total-=d._progress.total),e.jqXHR=d.jqXHR=a,e.textStatus=d.textStatus=b,e.errorThrown=d.errorThrown=c,this._trigger("fail",null,d)},_onAlways:function(a,b,c,d){this._trigger("always",null,d)},_onSend:function(b,c){c.submit||this._addConvenienceMethods(b,c);var d,e,f,g,h=this,i=h._getAJAXSettings(c),j=function(){return h._sending+=1,i._bitrateTimer=new h._BitrateTimer,d=d||((e||h._trigger("send",b,i)===!1)&&h._getXHRPromise(!1,i.context,e)||h._chunkedUpload(i)||a.ajax(i)).done(function(a,b,c){h._onDone(a,b,c,i)
}).fail(function(a,b,c){h._onFail(a,b,c,i)}).always(function(a,b,c){if(h._onAlways(a,b,c,i),h._sending-=1,h._active-=1,i.limitConcurrentUploads&&i.limitConcurrentUploads>h._sending)for(var d=h._slots.shift();d;){if("pending"===h._getDeferredState(d)){d.resolve();break}d=h._slots.shift()}0===h._active&&h._trigger("stop")})};return this._beforeSend(b,i),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(f=a.Deferred(),this._slots.push(f),g=f.pipe(j)):g=this._sequence=this._sequence.pipe(j,j),g.abort=function(){return e=[void 0,"abort","abort"],d?d.abort():(f&&f.rejectWith(i.context,e),j())},this._enhancePromise(g)):j()},_onAdd:function(b,c){var d,e,f,g,h=this,i=!0,j=a.extend({},this.options,c),k=j.limitMultiFileUploads,l=this._getParamName(j);if((j.singleFileUploads||k)&&this._isXHRUpload(j))if(!j.singleFileUploads&&k)for(f=[],d=[],g=0;g<c.files.length;g+=k)f.push(c.files.slice(g,g+k)),e=l.slice(g,g+k),e.length||(e=l),d.push(e);else d=l;else f=[c.files],d=[l];return c.originalFiles=c.files,a.each(f||c.files,function(e,g){var j=a.extend({},c);return j.files=f?g:[g],j.paramName=d[e],h._initResponseObject(j),h._initProgressObject(j),h._addConvenienceMethods(b,j),i=h._trigger("add",b,j)}),i},_replaceFileInput:function(b){var c=b.clone(!0);a("<form></form>").append(c)[0].reset(),b.after(c).detach(),a.cleanData(b.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(a,d){return d===b[0]?c[0]:d}),b[0]===this.element[0]&&(this.element=c)},_handleFileTreeEntry:function(b,c){var d,e=this,f=a.Deferred(),g=function(a){a&&!a.entry&&(a.entry=b),f.resolve([a])};return c=c||"",b.isFile?b._file?(b._file.relativePath=c,f.resolve(b._file)):b.file(function(a){a.relativePath=c,f.resolve(a)},g):b.isDirectory?(d=b.createReader(),d.readEntries(function(a){e._handleFileTreeEntries(a,c+b.name+"/").done(function(a){f.resolve(a)}).fail(g)},g)):f.resolve([]),f.promise()},_handleFileTreeEntries:function(b,c){var d=this;return a.when.apply(a,a.map(b,function(a){return d._handleFileTreeEntry(a,c)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(b){b=b||{};var c=b.items;return c&&c.length&&(c[0].webkitGetAsEntry||c[0].getAsEntry)?this._handleFileTreeEntries(a.map(c,function(a){var b;return a.webkitGetAsEntry?(b=a.webkitGetAsEntry(),b&&(b._file=a.getAsFile()),b):a.getAsEntry()})):a.Deferred().resolve(a.makeArray(b.files)).promise()},_getSingleFileInputFiles:function(b){b=a(b);var c,d,e=b.prop("webkitEntries")||b.prop("entries");if(e&&e.length)return this._handleFileTreeEntries(e);if(c=a.makeArray(b.prop("files")),c.length)void 0===c[0].name&&c[0].fileName&&a.each(c,function(a,b){b.name=b.fileName,b.size=b.fileSize});else{if(d=b.prop("value"),!d)return a.Deferred().resolve([]).promise();c=[{name:d.replace(/^.*\\/,"")}]}return a.Deferred().resolve(c).promise()},_getFileInputFiles:function(b){return b instanceof a&&1!==b.length?a.when.apply(a,a.map(b,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(b)},_onChange:function(b){var c=this,d={fileInput:a(b.target),form:a(b.target.form)};this._getFileInputFiles(d.fileInput).always(function(a){d.files=a,c.options.replaceFileInput&&c._replaceFileInput(d.fileInput),c._trigger("change",b,d)!==!1&&c._onAdd(b,d)})},_onPaste:function(b){var c=b.originalEvent&&b.originalEvent.clipboardData&&b.originalEvent.clipboardData.items,d={files:[]};return c&&c.length&&(a.each(c,function(a,b){var c=b.getAsFile&&b.getAsFile();c&&d.files.push(c)}),this._trigger("paste",b,d)===!1||this._onAdd(b,d)===!1)?!1:void 0},_onDrop:function(a){var b=this,c=a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer,d={};c&&c.files&&c.files.length&&(a.preventDefault(),this._getDroppedFiles(c).always(function(c){d.files=c,b._trigger("drop",a,d)!==!1&&b._onAdd(a,d)}))},_onDragOver:function(b){var c=b.dataTransfer=b.originalEvent&&b.originalEvent.dataTransfer;if(c){if(this._trigger("dragover",b)===!1)return!1;-1!==a.inArray("Files",c.types)&&(c.dropEffect="copy",b.preventDefault())}},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(b,c){var d=-1!==a.inArray(b,this._specialOptions);d&&this._destroyEventHandlers(),this._super(b,c),d&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var b=this.options;void 0===b.fileInput?b.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):b.fileInput instanceof a||(b.fileInput=a(b.fileInput)),b.dropZone instanceof a||(b.dropZone=a(b.dropZone)),b.pasteZone instanceof a||(b.pasteZone=a(b.pasteZone))},_getRegExp:function(a){var b=a.split("/"),c=b.pop();return b.shift(),new RegExp(b.join("/"),c)},_isRegExpOption:function(b,c){return"url"!==b&&"string"===a.type(c)&&/^\/.*\/[igm]{0,3}$/.test(c)},_initDataAttributes:function(){var b=this,c=this.options;a.each(a(this.element[0].cloneNode(!1)).data(),function(a,d){b._isRegExpOption(a,d)&&(d=b._getRegExp(d)),c[a]=d})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(b){var c=this;b&&!this.options.disabled&&(b.fileInput&&!b.files?this._getFileInputFiles(b.fileInput).always(function(a){b.files=a,c._onAdd(null,b)}):(b.files=a.makeArray(b.files),this._onAdd(null,b)))},send:function(b){if(b&&!this.options.disabled){if(b.fileInput&&!b.files){var c,d,e=this,f=a.Deferred(),g=f.promise();return g.abort=function(){return d=!0,c?c.abort():(f.reject(null,"abort","abort"),g)},this._getFileInputFiles(b.fileInput).always(function(a){d||(b.files=a,c=e._onSend(null,b).then(function(a,b,c){f.resolve(a,b,c)},function(a,b,c){f.reject(a,b,c)}))}),this._enhancePromise(g)}if(b.files=a.makeArray(b.files),b.files.length)return this._onSend(null,b)}return this._getXHRPromise(!1,b&&b.context)}})}),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","./jquery.fileupload"],a):a(window.jQuery)}(function(a){"use strict";var b=a.blueimp.fileupload.prototype.options.add;a.widget("blueimp.fileupload",a.blueimp.fileupload,{options:{processQueue:[],add:function(c,d){var e=a(this);d.process(function(){return e.fileupload("process",d)}),b.call(this,c,d)}},processActions:{},_processFile:function(b){var c=this,d=a.Deferred().resolveWith(c,[b]),e=d.promise();return this._trigger("process",null,b),a.each(b.processQueue,function(a,b){var d=function(a){return c.processActions[b.action].call(c,a,b)};e=e.pipe(d,b.always&&d)}),e.done(function(){c._trigger("processdone",null,b),c._trigger("processalways",null,b)}).fail(function(){c._trigger("processfail",null,b),c._trigger("processalways",null,b)}),e},_transformProcessQueue:function(b){var c=[];a.each(b.processQueue,function(){var d={};a.each(this,function(c,e){d[c]="string"===a.type(e)&&"@"===e.charAt(0)?b[e.slice(1)]:e}),c.push(d)}),b.processQueue=c},processing:function(){return this._processing},process:function(b){var c=this,d=a.extend({},this.options,b);return d.processQueue&&d.processQueue.length&&(this._transformProcessQueue(d),0===this._processing&&this._trigger("processstart"),a.each(b.files,function(b){var e=b?a.extend({},d):d,f=function(){return c._processFile(e)};e.index=b,c._processing+=1,c._processingQueue=c._processingQueue.pipe(f,f).always(function(){c._processing-=1,0===c._processing&&c._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=a.Deferred().resolveWith(this).promise()}})}),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","load-image","canvas-to-blob","./jquery.fileupload-process"],a):a(window.jQuery,window.loadImage)}(function(a,b){"use strict";a.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImage",fileTypes:"@loadImageFileTypes",maxFileSize:"@loadImageMaxFileSize",noRevoke:"@loadImageNoRevoke",disabled:"@disableImageLoad"},{action:"resizeImage",maxWidth:"@imageMaxWidth",maxHeight:"@imageMaxHeight",minWidth:"@imageMinWidth",minHeight:"@imageMinHeight",crop:"@imageCrop",disabled:"@disableImageResize"},{action:"saveImage",disabled:"@disableImageResize"},{action:"resizeImage",maxWidth:"@previewMaxWidth",maxHeight:"@previewMaxHeight",minWidth:"@previewMinWidth",minHeight:"@previewMinHeight",crop:"@previewCrop",canvas:"@previewAsCanvas",disabled:"@disableImagePreview"},{action:"setImage",name:"preview",disabled:"@disableImagePreview"}),a.widget("blueimp.fileupload",a.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png)$/,loadImageMaxFileSize:5e6,imageMaxWidth:1920,imageMaxHeight:1080,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewCrop:!1,previewAsCanvas:!0},processActions:{loadImage:function(c,d){if(d.disabled)return c;var e=this,f=c.files[c.index],g=a.Deferred();return("number"===a.type(d.maxFileSize)&&f.size>d.maxFileSize||d.fileTypes&&!d.fileTypes.test(f.type)||!b(f,function(a){return a.src?(c.img=a,g.resolveWith(e,[c]),void 0):g.rejectWith(e,[c])},d))&&g.rejectWith(e,[c]),g.promise()},resizeImage:function(c,d){d=a.extend({canvas:!0},d);var e,f=d.canvas&&c.canvas||c.img;return f&&!d.disabled&&(e=b.scale(f,d),!e||e.width===f.width&&e.height===f.height||(c[e.getContext?"canvas":"img"]=e)),c},saveImage:function(b,c){if(!b.canvas||c.disabled)return b;var d=this,e=b.files[b.index],f=e.name,g=a.Deferred(),h=function(a){a.name||(e.type===a.type?a.name=e.name:e.name&&(a.name=e.name.replace(/\..+$/,"."+a.type.substr(6)))),b.files[b.index]=a,g.resolveWith(d,[b])};if(b.canvas.mozGetAsFile)h(b.canvas.mozGetAsFile(/^image\/(jpeg|png)$/.test(e.type)&&f||(f&&f.replace(/\..+$/,"")||"blob")+".png",e.type));else{if(!b.canvas.toBlob)return b;b.canvas.toBlob(h,e.type)}return g.promise()},setImage:function(a,b){var c=a.canvas||a.img;return c&&!b.disabled&&(a.files[a.index][b.name]=c),a}}})}),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","./jquery.fileupload-process"],a):a(window.jQuery)}(function(a){"use strict";a.blueimp.fileupload.prototype.options.processQueue.push({action:"validate",always:!0,acceptFileTypes:"@acceptFileTypes",maxFileSize:"@maxFileSize",minFileSize:"@minFileSize",maxNumberOfFiles:"@maxNumberOfFiles",disabled:"@disableValidation"}),a.widget("blueimp.fileupload",a.blueimp.fileupload,{options:{getNumberOfFiles:a.noop,messages:{maxNumberOfFiles:"Maximum number of files exceeded",acceptFileTypes:"File type not allowed",maxFileSize:"File is too large",minFileSize:"File is too small"}},processActions:{validate:function(b,c){if(c.disabled)return b;var d=a.Deferred(),e=this.options,f=b.files[b.index],g=e.getNumberOfFiles();return g&&"number"===a.type(c.maxNumberOfFiles)&&g+b.files.length>c.maxNumberOfFiles?f.error=e.i18n("maxNumberOfFiles"):!c.acceptFileTypes||c.acceptFileTypes.test(f.type)||c.acceptFileTypes.test(f.name)?c.maxFileSize&&f.size>c.maxFileSize?f.error=e.i18n("maxFileSize"):"number"===a.type(f.size)&&f.size<c.minFileSize?f.error=e.i18n("minFileSize"):delete f.error:f.error=e.i18n("acceptFileTypes"),f.error||b.files.error?(b.files.error=!0,d.rejectWith(this,[b])):d.resolveWith(this,[b]),d.promise()}}})}),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","tmpl","./jquery.fileupload-resize","./jquery.fileupload-validate"],a):a(window.jQuery,window.tmpl)}(function(a,b){"use strict";a.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId"),a.widget("blueimp.fileupload",a.blueimp.fileupload,{options:{autoUpload:!1,uploadTemplateId:"template-upload",downloadTemplateId:"template-download",filesContainer:void 0,prependFiles:!1,dataType:"json",getNumberOfFiles:function(){return this.filesContainer.children().length},getFilesFromResponse:function(b){if(b.result&&(a.isArray(b.result.files)||a.isArray(b.result.archivoImagen)||a.isArray(b.result.archivoMiniatura))){if(a.isArray(b.result.archivoImagen))return b.result.archivoImagen;if(a.isArray(b.result.archivoMiniatura))return b.result.archivoMiniatura;if(a.isArray(b.result.files))return b.result.files}return[]},add:function(b,c){var d=a(this),e=d.data("blueimp-fileupload")||d.data("fileupload"),f=e.options,g=c.files;c.process(function(){return d.fileupload("process",c)}).always(function(){c.context=e._renderUpload(g).data("data",c),e._renderPreviews(c),f.filesContainer[f.prependFiles?"prepend":"append"](c.context),e._forceReflow(c.context),e._transition(c.context).done(function(){e._trigger("added",b,c)===!1||!f.autoUpload&&!c.autoUpload||c.autoUpload===!1||c.files.error||c.submit()})})},send:function(b,c){var d=a(this).data("blueimp-fileupload")||a(this).data("fileupload");return c.context&&c.dataType&&"iframe"===c.dataType.substr(0,6)&&c.context.find(".progress").addClass(!a.support.transition&&"progress-animated").attr("aria-valuenow",100).find(".bar").css("width","100%"),d._trigger("sent",b,c)},done:function(b,c){var d,e,f=a(this).data("blueimp-fileupload")||a(this).data("fileupload"),g=c.getFilesFromResponse||f.options.getFilesFromResponse,h=g(c);c.context?c.context.each(function(e){var g=h[e]||{error:"Empty file upload result"},i=f._addFinishedDeferreds();f._transition(a(this)).done(function(){var e=a(this);d=f._renderDownload([g]).replaceAll(e),f._forceReflow(d),f._transition(d).done(function(){c.context=a(this),f._trigger("completed",b,c),f._trigger("finished",b,c),i.resolve()})})}):(d=f._renderDownload(h).appendTo(f.options.filesContainer),f._forceReflow(d),e=f._addFinishedDeferreds(),f._transition(d).done(function(){c.context=a(this),f._trigger("completed",b,c),f._trigger("finished",b,c),e.resolve()}))},fail:function(b,c){var d,e,f=a(this).data("blueimp-fileupload")||a(this).data("fileupload");c.context?c.context.each(function(g){if("abort"!==c.errorThrown){var h=c.files[g];h.error=h.error||c.errorThrown||!0,e=f._addFinishedDeferreds(),f._transition(a(this)).done(function(){var g=a(this);d=f._renderDownload([h]).replaceAll(g),f._forceReflow(d),f._transition(d).done(function(){c.context=a(this),f._trigger("failed",b,c),f._trigger("finished",b,c),e.resolve()})})}else e=f._addFinishedDeferreds(),f._transition(a(this)).done(function(){a(this).remove(),f._trigger("failed",b,c),f._trigger("finished",b,c),e.resolve()})}):"abort"!==c.errorThrown?(c.context=f._renderUpload(c.files).appendTo(f.options.filesContainer).data("data",c),f._forceReflow(c.context),e=f._addFinishedDeferreds(),f._transition(c.context).done(function(){c.context=a(this),f._trigger("failed",b,c),f._trigger("finished",b,c),e.resolve()})):(f._trigger("failed",b,c),f._trigger("finished",b,c),f._addFinishedDeferreds().resolve())},progress:function(a,b){if(b.context){var c=Math.floor(100*(b.loaded/b.total));b.context.find(".progress").attr("aria-valuenow",c).find(".bar").css("width",c+"%")}},progressall:function(b,c){var d=a(this),e=Math.floor(100*(c.loaded/c.total)),f=d.find(".fileupload-progress"),g=f.find(".progress-extended");g.length&&g.html((d.data("blueimp-fileupload")||d.data("fileupload"))._renderExtendedProgress(c)),f.find(".progress").attr("aria-valuenow",e).find(".bar").css("width",e+"%")},start:function(b){var c=a(this).data("blueimp-fileupload")||a(this).data("fileupload");c._resetFinishedDeferreds(),c._transition(a(this).find(".fileupload-progress")).done(function(){c._trigger("started",b)})},stop:function(b){var c=a(this).data("blueimp-fileupload")||a(this).data("fileupload"),d=c._addFinishedDeferreds();a.when.apply(a,c._getFinishedDeferreds()).done(function(){c._trigger("stopped",b)}),c._transition(a(this).find(".fileupload-progress")).done(function(){a(this).find(".progress").attr("aria-valuenow","0").find(".bar").css("width","0%"),a(this).find(".progress-extended").html("&nbsp;"),d.resolve()})},processstart:function(){a(this).addClass("fileupload-processing")},processstop:function(){a(this).removeClass("fileupload-processing")},destroy:function(b,c){var d=a(this).data("blueimp-fileupload")||a(this).data("fileupload");c.url&&a.ajax(c).done(function(){d._transition(c.context).done(function(){a(this).remove(),d._trigger("destroyed",b,c)})})}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(b){return b||(b=a.Deferred()),this._finishedUploads.push(b),b},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var b=a(this),c=b.prop("href"),d=b.prop("download"),e="application/octet-stream";b.bind("dragstart",function(a){try{a.originalEvent.dataTransfer.setData("DownloadURL",[e,d,c].join(":"))}catch(b){}})},_formatFileSize:function(a){return"number"!=typeof a?"":a>=1e9?(a/1e9).toFixed(2)+" GB":a>=1e6?(a/1e6).toFixed(2)+" MB":(a/1e3).toFixed(2)+" KB"},_formatBitrate:function(a){return"number"!=typeof a?"":a>=1e9?(a/1e9).toFixed(2)+" Gbit/s":a>=1e6?(a/1e6).toFixed(2)+" Mbit/s":a>=1e3?(a/1e3).toFixed(2)+" kbit/s":a.toFixed(2)+" bit/s"},_formatTime:function(a){var b=new Date(1e3*a),c=Math.floor(a/86400);return c=c?c+"d ":"",c+("0"+b.getUTCHours()).slice(-2)+":"+("0"+b.getUTCMinutes()).slice(-2)+":"+("0"+b.getUTCSeconds()).slice(-2)},_formatPercentage:function(a){return(100*a).toFixed(2)+" %"},_renderExtendedProgress:function(a){return this._formatBitrate(a.bitrate)+" | "+this._formatTime(8*(a.total-a.loaded)/a.bitrate)+" | "+this._formatPercentage(a.loaded/a.total)+" | "+this._formatFileSize(a.loaded)+" / "+this._formatFileSize(a.total)},_renderTemplate:function(b,c){if(!b)return a();var d=b({files:c,formatFileSize:this._formatFileSize,options:this.options});return d instanceof a?d:a(this.options.templatesContainer).html(d).children()},_renderPreviews:function(b){b.context.find(".preview").each(function(c,d){a(d).append(b.files[c].preview)})},_renderUpload:function(a){return this._renderTemplate(this.options.uploadTemplate,a)},_renderDownload:function(a){return this._renderTemplate(this.options.downloadTemplate,a).find("a[download]").each(this._enableDragToDesktop).end()},_startHandler:function(b){b.preventDefault();var c=a(b.currentTarget),d=c.closest(".template-upload"),e=d.data("data");e&&e.submit&&!e.jqXHR&&e.submit()&&c.prop("disabled",!0)},_cancelHandler:function(b){b.preventDefault();var c=a(b.currentTarget).closest(".template-upload"),d=c.data("data")||{};d.jqXHR?d.jqXHR.abort():(d.errorThrown="abort",this._trigger("fail",b,d))},_deleteHandler:function(b){b.preventDefault();var c=a(b.currentTarget);this._trigger("destroy",b,a.extend({context:c.closest(".template-download"),type:"DELETE"},c.data()))},_forceReflow:function(b){return a.support.transition&&b.length&&b[0].offsetWidth},_transition:function(b){var c=a.Deferred();return a.support.transition&&b.hasClass("fade")&&b.is(":visible")?b.bind(a.support.transition.end,function(d){d.target===b[0]&&(b.unbind(a.support.transition.end),c.resolveWith(b))}).toggleClass("in"):(b.toggleClass("in"),c.resolveWith(b)),c},_initButtonBarEventHandlers:function(){var b=this.element.find(".fileupload-buttonbar"),c=this.options.filesContainer;this._on(b.find(".start"),{click:function(a){a.preventDefault(),c.find(".start").click()}}),this._on(b.find(".cancel"),{click:function(a){a.preventDefault(),c.find(".cancel").click()}}),this._on(b.find(".delete"),{click:function(a){a.preventDefault(),c.find(".toggle:checked").closest(".template-download").find(".delete").click(),b.find(".toggle").prop("checked",!1)}}),this._on(b.find(".toggle"),{change:function(b){c.find(".toggle").prop("checked",a(b.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".start, .cancel, .delete"),"click"),this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super(),this._on(this.options.filesContainer,{"click .start":this._startHandler,"click .cancel":this._cancelHandler,"click .delete":this._deleteHandler}),this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers(),this._off(this.options.filesContainer,"click"),this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!1).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",!0).parent().addClass("disabled")},_initTemplates:function(){var a=this.options;a.templatesContainer=this.document[0].createElement(a.filesContainer.prop("nodeName")),b&&(a.uploadTemplateId&&(a.uploadTemplate=b(a.uploadTemplateId)),a.downloadTemplateId&&(a.downloadTemplate=b(a.downloadTemplateId)))},_initFilesContainer:function(){var b=this.options;void 0===b.filesContainer?b.filesContainer=this.element.find(".files"):b.filesContainer instanceof a||(b.filesContainer=a(b.filesContainer))},_initSpecialOptions:function(){this._super(),this._initFilesContainer(),this._initTemplates()},_create:function(){this._super(),this._resetFinishedDeferreds()},enable:function(){var a=!1;this.options.disabled&&(a=!0),this._super(),a&&(this.element.find("input, button").prop("disabled",!1),this._enableFileInputButton())},disable:function(){this.options.disabled||(this.element.find("input, button").prop("disabled",!0),this._disableFileInputButton()),this._super()}})});